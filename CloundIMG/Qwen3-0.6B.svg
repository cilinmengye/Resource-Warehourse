<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2862.0261908932025 1344.200985499787" width="2862.0261908932025" height="1344.200985499787"><!-- svg-source:excalidraw --><metadata></metadata><defs><style class="style-fonts">
      @font-face { font-family: Comic Shanns; src: url(data:font/woff2;base64,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); }</style></defs><rect x="0" y="0" width="2862.0261908932025" height="1344.200985499787" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 380.6285599204955) rotate(0 627.9918859240311 402.46548179486643)"><path d="M32 0 C273.86 2.32, 515.47 2.61, 1223.98 0 M32 0 C290.43 -1.85, 548.26 -1.83, 1223.98 0 M1223.98 0 C1246.01 -0.2, 1256.74 11.84, 1255.98 32 M1223.98 0 C1243.51 -0.42, 1257.68 12.84, 1255.98 32 M1255.98 32 C1258.73 242.3, 1258.02 451.6, 1255.98 772.93 M1255.98 32 C1255.59 295.74, 1255.44 560.14, 1255.98 772.93 M1255.98 772.93 C1254.13 794.69, 1245.09 804.02, 1223.98 804.93 M1255.98 772.93 C1257.82 795.69, 1245.01 806.77, 1223.98 804.93 M1223.98 804.93 C775.72 808.33, 326.6 807.44, 32 804.93 M1223.98 804.93 C948.99 807.6, 674.32 807.78, 32 804.93 M32 804.93 C10.25 805.59, 0.08 793.07, 0 772.93 M32 804.93 C10.46 803.21, 1.15 795.15, 0 772.93 M0 772.93 C1.29 613.68, 1.12 453.66, 0 32 M0 772.93 C2.39 587.1, 2.32 401.49, 0 32 M0 32 C0.71 8.81, 9.2 -1.82, 32 0 M0 32 C-1.9 8.66, 8.57 -0.06, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(554.2122608364471 1049.5783558876988) rotate(0 61.94324122031577 30)"><path d="M15 0 C37.19 0.2, 63.95 -0.78, 108.89 0 M15 0 C38.43 -0.02, 61.34 1.23, 108.89 0 M108.89 0 C117.7 -0.68, 122.34 6.15, 123.89 15 M108.89 0 C119.98 0.74, 122.36 6.45, 123.89 15 M123.89 15 C123.14 22.16, 124.61 25.89, 123.89 45 M123.89 15 C124.74 21.54, 123.33 29.99, 123.89 45 M123.89 45 C122.97 56.41, 118.04 61.4, 108.89 60 M123.89 45 C125.24 53.39, 119.1 59.03, 108.89 60 M108.89 60 C78.9 62.06, 49.64 60.71, 15 60 M108.89 60 C86.04 61.11, 64.43 59.72, 15 60 M15 60 C6.96 58.61, -0.96 55.19, 0 45 M15 60 C4.02 58.09, 1.05 54.92, 0 45 M0 45 C0.39 33.62, -1.88 25.75, 0 15 M0 45 C-0.93 35.52, 0.11 26.06, 0 15 M0 15 C0.94 3.49, 3.85 -1.57, 15 0 M0 15 C-0.98 3.61, 3.84 -0.85, 15 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(561.155502056763 1054.5783558876988) rotate(0 55 25)"><text x="55" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">embed_toke</text><text x="55" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ns</text></g><g stroke-linecap="round" transform="translate(685.2589697061019 1021.0281579175248) rotate(0 288.201332527125 80)"><path d="M32 0 C163.96 -0.08, 297.33 -1.06, 544.4 0 M544.4 0 C566.63 1.42, 574.46 12.32, 576.4 32 M576.4 32 C576.77 59.88, 576.04 90.13, 576.4 128 M576.4 128 C576.37 147.68, 564.3 159.5, 544.4 160 M544.4 160 C365.74 158.28, 186.65 158.33, 32 160 M32 160 C11.93 158.03, -1.85 149.98, 0 128 M0 128 C-1.13 101.69, -0.19 72.99, 0 32 M0 32 C-0.5 12.28, 9.18 0.82, 32 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(692.4603022332269 1026.0281579175248) rotate(0 281 75)"><text x="281" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">VocabParallelEmbedding</text><text x="281" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(num_embedding,embedding_dim==hidden_size)</text><text x="281" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(151936, 1024)</text><text x="281" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="281" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">本质操作y = F.embedding(x, self.weight)</text><text x="281" y="142.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">最后会dist.all_reduce(y)为使所有GPU都有完整的相同输入X</text></g><g stroke-linecap="round"><g transform="translate(613.8129870877021 1204.4127528670435) rotate(0 -0.29529257671936193 -42.75503130683947)"><path d="M0 0 C-1.88 -20.6, -0.16 -41.21, -0.59 -85.51 M0 0 C0.51 -18.24, -1.07 -35.97, -0.59 -85.51" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(613.8129870877021 1204.4127528670435) rotate(0 -0.29529257671936193 -42.75503130683947)"><path d="M7.97 -62.02 C4.64 -67.76, 4.45 -73.59, -0.59 -85.51 M7.97 -62.02 C6.73 -67.05, 3.44 -71.5, -0.59 -85.51" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(613.8129870877021 1204.4127528670435) rotate(0 -0.29529257671936193 -42.75503130683947)"><path d="M-9.13 -62.01 C-8.39 -67.92, -4.49 -73.75, -0.59 -85.51 M-9.13 -62.01 C-6.71 -66.9, -6.34 -71.36, -0.59 -85.51" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(574.2915740086517 1215.6755615150023) rotate(0 40.18139883364968 17.5)"><path d="M8.75 0 C25.56 -1.36, 43.99 -0.83, 71.61 0 M8.75 0 C29.53 0.06, 50.31 -1.12, 71.61 0 M71.61 0 C75.96 1.41, 81.96 3.51, 80.36 8.75 M71.61 0 C78.49 -1.67, 82.27 3.06, 80.36 8.75 M80.36 8.75 C81.56 13.81, 80.16 18.86, 80.36 26.25 M80.36 8.75 C80.66 12.7, 79.89 15.57, 80.36 26.25 M80.36 26.25 C80.81 32.49, 75.66 36.97, 71.61 35 M80.36 26.25 C79.22 33.03, 75.97 34.17, 71.61 35 M71.61 35 C47.05 34.01, 26.57 36.35, 8.75 35 M71.61 35 C51 35.64, 29.27 33.9, 8.75 35 M8.75 35 C0.92 34.21, 1.63 34.05, 0 26.25 M8.75 35 C1.64 34.33, -1.82 30.14, 0 26.25 M0 26.25 C1.12 20.85, 1.77 15.37, 0 8.75 M0 26.25 C-0.47 20.34, 0.51 15.38, 0 8.75 M0 8.75 C-0.01 4.23, 4.91 -0.4, 8.75 0 M0 8.75 C0.86 2.04, 4.85 0.35, 8.75 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(608.9729728423013 1220.6755615150023) rotate(0 5.5 12.5)"><text x="5.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">X</text></g><g stroke-linecap="round" transform="translate(686.0036983640248 1219.1476610375632) rotate(0 39.12212388777229 17.5)"><path d="M8.75 0 C21.46 -0.37, 34.62 1.35, 69.49 0 M69.49 0 C75.09 0.83, 78.92 3.67, 78.24 8.75 M78.24 8.75 C76.72 13.32, 78.88 19.5, 78.24 26.25 M78.24 26.25 C78.38 33.68, 74.37 35.13, 69.49 35 M69.49 35 C51.22 35.89, 35.73 35.32, 8.75 35 M8.75 35 C1.06 33.56, 0.76 33.43, 0 26.25 M0 26.25 C-0.84 22.94, 0.48 15.24, 0 8.75 M0 8.75 C-1.24 3.83, 2.83 1.35, 8.75 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(692.1258222517972 1224.1476610375632) rotate(0 33 12.5)"><text x="33" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s,)</text></g><g stroke-linecap="round"><g transform="translate(614.7438634052376 1043.7818826208177) rotate(0 0.749437308153972 -42.62359060977752)"><path d="M0 0 C1.53 -25.44, -0.44 -53.46, 1.5 -85.25 M0 0 C0.55 -24.19, 0.81 -49.81, 1.5 -85.25" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(614.7438634052376 1043.7818826208177) rotate(0 0.749437308153972 -42.62359060977752)"><path d="M9.63 -61.61 C8.35 -68.01, 3.4 -76.93, 1.5 -85.25 M9.63 -61.61 C7.12 -67.65, 4.54 -75.11, 1.5 -85.25" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(614.7438634052376 1043.7818826208177) rotate(0 0.749437308153972 -42.62359060977752)"><path d="M-7.47 -61.91 C-3.44 -68.11, -3.1 -76.93, 1.5 -85.25 M-7.47 -61.91 C-4.94 -67.85, -2.48 -75.22, 1.5 -85.25" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(527.4583653504103 903.5346839626467) rotate(0 89.55711204446368 26.571393694196445)"><path d="M13.29 0 C68.52 -0.43, 123.12 -1.6, 165.83 0 M13.29 0 C52.34 -0.46, 91.79 -0.41, 165.83 0 M165.83 0 C175.1 -0.72, 177.5 5.78, 179.11 13.29 M165.83 0 C173.21 1.33, 179.99 2.39, 179.11 13.29 M179.11 13.29 C178.39 24.26, 179.45 33.86, 179.11 39.86 M179.11 13.29 C178.5 20.25, 179 28.25, 179.11 39.86 M179.11 39.86 C177.93 48.58, 176.39 54.01, 165.83 53.14 M179.11 39.86 C177.93 48.53, 176.72 51.59, 165.83 53.14 M165.83 53.14 C113.67 53.25, 66.07 53.32, 13.29 53.14 M165.83 53.14 C131.59 53.64, 96.06 52.76, 13.29 53.14 M13.29 53.14 C6.3 54.55, 0.09 47.93, 0 39.86 M13.29 53.14 C5.45 52.87, 1.47 46.65, 0 39.86 M0 39.86 C0.61 30.28, -0.96 18.23, 0 13.29 M0 39.86 C-1.04 32.9, 0.42 26.02, 0 13.29 M0 13.29 C-1.37 3.01, 4.51 0.5, 13.29 0 M0 13.29 C1.34 5.32, 5.41 0.9, 13.29 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(534.5154773948739 917.6060776568431) rotate(0 82.5 12.5)"><text x="82.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">input_layernorm</text></g><g stroke-linecap="round"><g transform="translate(594.0425200119844 967.9167638816957) rotate(0 -46.81803171100776 0)"><path d="M0 0 C-33.63 1.23, -67.63 1.79, -93.64 0 M0 0 C-35.52 0.66, -70.33 -0.29, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(594.0425200119844 967.9167638816957) rotate(0 -46.81803171100776 0)"><path d="M-70.15 -8.55 C-78.96 -4.5, -88.08 -0.92, -93.64 0 M-70.15 -8.55 C-79.63 -4.51, -88.47 -2.29, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(594.0425200119844 967.9167638816957) rotate(0 -46.81803171100776 0)"><path d="M-70.14 8.55 C-78.83 6.53, -87.94 4.05, -93.64 0 M-70.14 8.55 C-79.72 6.26, -88.56 2.14, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(219.22964220084225 936.8969598438824) rotate(0 137.79660041333216 30)"><path d="M15 0 C68.41 -0.77, 123.69 0.81, 260.59 0 M260.59 0 C271.09 0.47, 276.64 3.24, 275.59 15 M275.59 15 C276.05 24.89, 276.39 39.46, 275.59 45 M275.59 45 C276.94 56.63, 268.84 59.03, 260.59 60 M260.59 60 C170.03 58.55, 76.9 57.29, 15 60 M15 60 C3.02 60.4, 1.15 54.19, 0 45 M0 45 C0.86 32.47, -0.29 21.26, 0 15 M0 15 C-1.31 6.92, 6.1 1.98, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(252.5262426141744 941.8969598438824) rotate(0 104.5 25)"><text x="104.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(b*s, hidden_size)</text><text x="104.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 1024)</text></g><g stroke-linecap="round" transform="translate(718.1018753385792 897.2892325253433) rotate(0 203.24029520733444 30)"><path d="M15 0 C93.04 -3.45, 172.15 -2.28, 391.48 0 M391.48 0 C403.26 -1.5, 408.43 6.82, 406.48 15 M406.48 15 C406.01 26.5, 405.76 38.16, 406.48 45 M406.48 45 C405.49 53.45, 402.79 61.56, 391.48 60 M391.48 60 C282.01 58.81, 173.83 59.4, 15 60 M15 60 C6.83 61.65, -1.68 53.61, 0 45 M0 45 C0.85 39.06, 0.19 30.43, 0 15 M0 15 C0.08 4.85, 5.71 -0.9, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(756.3421705459136 902.2892325253433) rotate(0 165 25)"><text x="165" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">RMSNorm eps=rms_num_eps=1e-06;</text><text x="165" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">γ weight(hidden_size==1024,)</text></g><g stroke-linecap="round"><g transform="translate(615.2441362705904 892.8853430783861) rotate(0 0.14310730567615337 -17.217926377591283)"><path d="M0 0 C-0.11 -6.98, -0.59 -14.1, 0.29 -34.44 M0 0 C-0.35 -10.88, -0.03 -21.67, 0.29 -34.44" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(615.2441362705904 892.8853430783861) rotate(0 0.14310730567615337 -17.217926377591283)"><path d="M5.78 -18.12 C4.43 -21.25, 2.79 -24.54, 0.29 -34.44 M5.78 -18.12 C3.74 -23.39, 2.24 -28.55, 0.29 -34.44" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(615.2441362705904 892.8853430783861) rotate(0 0.14310730567615337 -17.217926377591283)"><path d="M-5.99 -18.4 C-4.83 -21.53, -3.96 -24.76, 0.29 -34.44 M-5.99 -18.4 C-4.39 -23.53, -2.25 -28.61, 0.29 -34.44" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(542.3694975523797 747.8562502751848) rotate(0 74.12853625623825 51.16553867115539)"><path d="M25.58 0 C58.7 0.08, 95.34 -0.85, 122.67 0 M25.58 0 C48.54 -0.86, 74.08 0.09, 122.67 0 M122.67 0 C139.6 -0.01, 147.9 8.06, 148.26 25.58 M122.67 0 C140.82 1.23, 148.83 7.53, 148.26 25.58 M148.26 25.58 C146.79 41.1, 149.03 52.85, 148.26 76.75 M148.26 25.58 C148.42 36.81, 149.21 47.25, 148.26 76.75 M148.26 76.75 C148.07 95.02, 139.41 100.45, 122.67 102.33 M148.26 76.75 C147.49 93.84, 138.91 100.04, 122.67 102.33 M122.67 102.33 C84.14 100.85, 45.6 102.68, 25.58 102.33 M122.67 102.33 C98.75 102.65, 74.88 103.97, 25.58 102.33 M25.58 102.33 C9.97 101.22, -0.73 95.36, 0 76.75 M25.58 102.33 C6.3 103.94, -0.08 94.12, 0 76.75 M0 76.75 C1.86 67.25, -0.6 56.69, 0 25.58 M0 76.75 C0.25 64.72, 0.07 53.67, 0 25.58 M0 25.58 C-0.03 9.92, 6.79 -1.08, 25.58 0 M0 25.58 C1.04 8.23, 10.07 -1.45, 25.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(554.8980582226804 764.0217889463403) rotate(0 61.5999755859375 35)"><text x="61.5999755859375" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Qwen3Att</text><text x="61.5999755859375" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ention</text></g><g stroke-linecap="round"><g transform="translate(595.5568019979132 875.1246520670043) rotate(0 -46.81803171100776 0)"><path d="M0 0 C-21.53 0.7, -39.18 2.04, -93.64 0 M0 0 C-34.65 -0.18, -70.76 -0.48, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(595.5568019979132 875.1246520670043) rotate(0 -46.81803171100776 0)"><path d="M-70.23 -8.79 C-77.02 -6.44, -79.88 -3.25, -93.64 0 M-70.23 -8.79 C-78.23 -5.44, -87.73 -2.41, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(595.5568019979132 875.1246520670043) rotate(0 -46.81803171100776 0)"><path d="M-70.06 8.31 C-76.79 7.06, -79.69 6.65, -93.64 0 M-70.06 8.31 C-78.19 5.18, -87.75 1.73, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(218.77245112767332 848.4459209839546) rotate(0 137.79660041333216 30)"><path d="M15 0 C114.38 0.26, 211.7 -0.21, 260.59 0 M260.59 0 C270.43 -1, 276.03 6.08, 275.59 15 M275.59 15 C276.21 19.39, 276.95 29.53, 275.59 45 M275.59 45 C275.71 53.85, 271.03 60.16, 260.59 60 M260.59 60 C200.1 61.55, 140.56 59.18, 15 60 M15 60 C6.63 59.73, 0.37 55.21, 0 45 M0 45 C-0.96 35.58, 1.64 25.86, 0 15 M0 15 C-0.22 3.36, 6.77 -0.55, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(252.06905154100548 853.4459209839546) rotate(0 104.5 25)"><text x="104.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(b*s, hidden_size)</text><text x="104.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 1024)</text></g><g stroke-linecap="round" transform="translate(527.4803127200462 653.4053748022862) rotate(0 90.1285536948543 30)"><path d="M15 0 C60.98 -0.45, 105.54 -0.91, 165.26 0 M15 0 C65.41 -1.06, 115.67 -2.07, 165.26 0 M165.26 0 C175.33 1.31, 178.79 4.1, 180.26 15 M165.26 0 C173.27 -1.77, 181.71 3.72, 180.26 15 M180.26 15 C179.28 25.97, 180.43 37.03, 180.26 45 M180.26 15 C179.25 27.47, 180 39.25, 180.26 45 M180.26 45 C179.49 53.7, 173.32 61.7, 165.26 60 M180.26 45 C178.91 54.52, 177.37 62.2, 165.26 60 M165.26 60 C117.09 61.88, 64.13 62.14, 15 60 M165.26 60 C124.66 58.79, 85.5 59.38, 15 60 M15 60 C5.73 58.27, 1.93 53.96, 0 45 M15 60 C5.2 61.78, -0.17 54.86, 0 45 M0 45 C0.69 35.57, 0.69 26.37, 0 15 M0 45 C0.96 35.99, 0.63 26.32, 0 15 M0 15 C1.83 6.07, 3.54 -1.82, 15 0 M0 15 C1.27 3.42, 4.7 -1.39, 15 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(535.1088664149004 658.4053748022862) rotate(0 82.5 25)"><text x="82.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">post_attention_</text><text x="82.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">layernorm</text></g><g stroke-linecap="round"><g transform="translate(610.9151967785701 744.0372484988823) rotate(0 0.14310730567615337 -12.075060515426117)"><path d="M0 0 C0.79 -6.87, -0.63 -14.55, 0.29 -24.15 M0 0 C0.1 -9.43, 0.47 -18.93, 0.29 -24.15" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(610.9151967785701 744.0372484988823) rotate(0 0.14310730567615337 -12.075060515426117)"><path d="M4.49 -12.83 C3.69 -16.01, 1.55 -19.7, 0.29 -24.15 M4.49 -12.83 C2.82 -17.23, 1.31 -21.67, 0.29 -24.15" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(610.9151967785701 744.0372484988823) rotate(0 0.14310730567615337 -12.075060515426117)"><path d="M-3.77 -12.78 C-2.15 -15.99, -1.87 -19.7, 0.29 -24.15 M-3.77 -12.78 C-2.17 -17.2, -0.4 -21.67, 0.29 -24.15" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(718.5611220390856 656.3404743453863) rotate(0 201.24027486228243 30)"><path d="M15 0 C116.21 -0.62, 215.45 -0.71, 387.48 0 M387.48 0 C398.08 0.88, 402.41 4.08, 402.48 15 M402.48 15 C402.48 25.89, 401.78 33.32, 402.48 45 M402.48 45 C401.13 56.46, 397.99 59.95, 387.48 60 M387.48 60 C263.82 60.08, 138.01 59.36, 15 60 M15 60 C5.66 58.82, 0.83 53.18, 0 45 M0 45 C-0.76 37.95, -0.73 30.52, 0 15 M0 15 C-0.98 3.57, 6.39 -0.17, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(754.801396901368 661.3404743453863) rotate(0 165 25)"><text x="165" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">RMSNorm eps=rms_num_eps=1e-06;</text><text x="165" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">γ weight(hidden_size==1024,)</text></g><g stroke-linecap="round"><g transform="translate(598.8892574428298 727.5204480899512) rotate(0 -46.81803171100776 0)"><path d="M0 0 C-31.24 -0.75, -60.89 1.62, -93.64 0 M0 0 C-21.08 -0.68, -44.07 -0.79, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(598.8892574428298 727.5204480899512) rotate(0 -46.81803171100776 0)"><path d="M-70.25 -8.84 C-77.99 -6.57, -84.09 -1.24, -93.64 0 M-70.25 -8.84 C-75.13 -6.97, -81.96 -5.05, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(598.8892574428298 727.5204480899512) rotate(0 -46.81803171100776 0)"><path d="M-70.04 8.25 C-77.76 4.8, -83.93 4.4, -93.64 0 M-70.04 8.25 C-75.03 6.19, -81.9 4.17, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(219.88336848181854 704.0729520578834) rotate(0 137.79660041333216 30)"><path d="M15 0 C68.86 -1.34, 120.02 0.54, 260.59 0 M260.59 0 C272.58 -1.2, 275 5.43, 275.59 15 M275.59 15 C274.71 22.83, 276.63 30.26, 275.59 45 M275.59 45 C276.34 54.49, 269.97 60.56, 260.59 60 M260.59 60 C189.87 57.34, 119.42 58.85, 15 60 M15 60 C4.3 61.86, -1.8 55.3, 0 45 M0 45 C0.25 37.22, 1.78 29.99, 0 15 M0 15 C0.63 4.41, 6.25 -1.08, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(253.1799688951507 709.0729520578834) rotate(0 104.5 25)"><text x="104.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(b*s, hidden_size)</text><text x="104.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 1024)</text></g><g stroke-linecap="round"><g transform="translate(613.0288183234197 649.6186380353565) rotate(0 0.14310730567615337 -17.21792637759131)"><path d="M0 0 C-0.1 -12.24, -0.45 -22.78, 0.29 -34.44 M0 0 C0.17 -7.71, 0.44 -14.42, 0.29 -34.44" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(613.0288183234197 649.6186380353565) rotate(0 0.14310730567615337 -17.21792637759131)"><path d="M6.22 -18.27 C4.04 -24.38, 1.71 -29.02, 0.29 -34.44 M6.22 -18.27 C5.05 -22.06, 3.98 -24.98, 0.29 -34.44" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(613.0288183234197 649.6186380353565) rotate(0 0.14310730567615337 -17.21792637759131)"><path d="M-5.56 -18.24 C-3.87 -24.35, -2.32 -29, 0.29 -34.44 M-5.56 -18.24 C-4.23 -22.02, -2.81 -24.95, 0.29 -34.44" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(597.7783824626158 633.4978680570459) rotate(0 -46.81803171100776 0)"><path d="M0 0 C-19.54 2.64, -40.1 0.06, -93.64 0 M0 0 C-34.75 0.08, -70.35 0.26, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(597.7783824626158 633.4978680570459) rotate(0 -46.81803171100776 0)"><path d="M-70.1 -8.43 C-74.82 -4.6, -80.51 -5.39, -93.64 0 M-70.1 -8.43 C-78.28 -5.31, -87.39 -1.95, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(597.7783824626158 633.4978680570459) rotate(0 -46.81803171100776 0)"><path d="M-70.19 8.68 C-74.8 8.88, -80.47 4.46, -93.64 0 M-70.19 8.68 C-78.5 5.33, -87.58 2.23, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(545.7019953712274 505.7002083427128) rotate(0 74.12853625623825 51.165538671155446)"><path d="M25.58 0 C50.58 0.8, 75.89 1.9, 122.67 0 M25.58 0 C49.44 -0.55, 73.01 0.21, 122.67 0 M122.67 0 C141.21 0.02, 148.85 9.72, 148.26 25.58 M122.67 0 C137.9 -1.85, 149.82 6.43, 148.26 25.58 M148.26 25.58 C148.52 42.02, 149.71 59.72, 148.26 76.75 M148.26 25.58 C148.83 38.87, 148.75 53.52, 148.26 76.75 M148.26 76.75 C149.68 94.3, 139.06 102.06, 122.67 102.33 M148.26 76.75 C149.14 92.28, 141.44 101.07, 122.67 102.33 M122.67 102.33 C96.04 103.1, 68.76 99.95, 25.58 102.33 M122.67 102.33 C83.34 103.34, 46.43 102.27, 25.58 102.33 M25.58 102.33 C6.58 100.88, -0.52 94.94, 0 76.75 M25.58 102.33 C9.34 102.07, 0.64 95.34, 0 76.75 M0 76.75 C1.49 57.31, -1.52 39.62, 0 25.58 M0 76.75 C0.77 61.21, 1.31 46.45, 0 25.58 M0 25.58 C1.55 9.39, 9.89 -0.71, 25.58 0 M0 25.58 C-0.08 8.02, 9.59 0.07, 25.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(558.2305560415282 539.3657470138683) rotate(0 61.5999755859375 17.5)"><text x="61.5999755859375" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Qwen3MLP</text></g><g stroke-linecap="round" transform="translate(219.88336848181865 606.2898366775513) rotate(0 137.79660041333216 30)"><path d="M15 0 C87.95 -0.48, 161.32 -1.31, 260.59 0 M260.59 0 C270.45 -1.3, 275.98 3.5, 275.59 15 M275.59 15 C277.34 20.07, 277.15 30.12, 275.59 45 M275.59 45 C275.04 56.2, 271.2 61.45, 260.59 60 M260.59 60 C190.32 61.78, 121.52 62.92, 15 60 M15 60 C3.83 61.27, 0.66 56.41, 0 45 M0 45 C1.85 36.28, -0.14 29.16, 0 15 M0 15 C-1.5 5.47, 3.45 -1.49, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(253.1799688951508 611.2898366775513) rotate(0 104.5 25)"><text x="104.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(b*s, hidden_size)</text><text x="104.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 1024)</text></g><g stroke-linecap="round"><g transform="translate(616.4167590309851 502.99199679876165) rotate(0 -0.4122878104994925 -25.5489378680889)"><path d="M0 0 C-2.1 -17.58, -1.53 -36.43, -0.82 -51.1 M0 0 C0.9 -10.65, -0.59 -21.3, -0.82 -51.1" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(616.4167590309851 502.99199679876165) rotate(0 -0.4122878104994925 -25.5489378680889)"><path d="M8.2 -27.78 C3.2 -35.06, 0.74 -43.64, -0.82 -51.1 M8.2 -27.78 C7.09 -32.41, 3.82 -37.03, -0.82 -51.1" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(616.4167590309851 502.99199679876165) rotate(0 -0.4122878104994925 -25.5489378680889)"><path d="M-8.89 -27.44 C-7.58 -34.89, -3.72 -43.6, -0.82 -51.1 M-8.89 -27.44 C-6.29 -32.11, -5.85 -36.81, -0.82 -51.1" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(542.3695399263108 400.1735684338796) rotate(0 74.12853625623825 23.395359123059563)"><path d="M11.7 0 C35.83 1.35, 64.36 -1.29, 136.56 0 M11.7 0 C51.94 1.32, 91.71 1.33, 136.56 0 M136.56 0 C144.94 0.67, 147.19 2.67, 148.26 11.7 M136.56 0 C143.54 0.4, 146.62 5.58, 148.26 11.7 M148.26 11.7 C147.33 18.07, 149.71 24.22, 148.26 35.09 M148.26 11.7 C147.68 17.47, 149.06 23.97, 148.26 35.09 M148.26 35.09 C146.26 43.62, 145.28 48.17, 136.56 46.79 M148.26 35.09 C146.14 44.83, 144.33 47.62, 136.56 46.79 M136.56 46.79 C107.91 47.58, 76.98 47.72, 11.7 46.79 M136.56 46.79 C101.33 47.47, 68.46 45.9, 11.7 46.79 M11.7 46.79 C3.93 45.99, -1.27 44.06, 0 35.09 M11.7 46.79 C3.35 46.39, -0.3 41.76, 0 35.09 M0 35.09 C-1.95 29.33, -0.31 19.82, 0 11.7 M0 35.09 C-0.45 30.65, 0.06 24.99, 0 11.7 M0 11.7 C0.34 3.14, 4.1 0.54, 11.7 0 M0 11.7 C0.69 4.63, 3.58 -0.66, 11.7 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(594.4980761825491 411.06892755693923) rotate(0 22 12.5)"><text x="22" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">norm</text></g><g stroke-linecap="round" transform="translate(701.4182648962283 401.90134062792436) rotate(0 201.906931356423 25)"><path d="M12.5 0 C103.03 -1.32, 194.27 -1.67, 391.31 0 M391.31 0 C400.72 1.37, 404.79 4.09, 403.81 12.5 M403.81 12.5 C403 20.39, 403.31 31.99, 403.81 37.5 M403.81 37.5 C403.5 45.37, 398.36 51.26, 391.31 50 M391.31 50 C287.4 51.57, 181.46 51.75, 12.5 50 M12.5 50 C4.7 48.27, -1.3 45.09, 0 37.5 M0 37.5 C-1.83 31.06, -1.62 25.09, 0 12.5 M0 12.5 C-1.62 3.8, 3.13 -1.78, 12.5 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(771.32537935812 406.90134062792436) rotate(0 131.99981689453125 20)"><text x="131.99981689453125" y="14" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">RMSNorm eps=rms_num_eps=1e-06;</text><text x="131.99981689453125" y="34" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">γ weight(hidden_size==1024,)</text></g><g stroke-linecap="round"><g transform="translate(613.6197483689889 394.1330921277024) rotate(0 -0.41233018443074343 -40.544902622350605)"><path d="M0 0 C0.21 -29.79, 0.66 -63.44, -0.82 -81.09 M0 0 C0.31 -29.36, -0.61 -60.28, -0.82 -81.09" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(613.6197483689889 394.1330921277024) rotate(0 -0.41233018443074343 -40.544902622350605)"><path d="M8.09 -57.73 C5.15 -65.21, 2.46 -76.51, -0.82 -81.09 M8.09 -57.73 C4.85 -65.72, 0.94 -75.32, -0.82 -81.09" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(613.6197483689889 394.1330921277024) rotate(0 -0.41233018443074343 -40.544902622350605)"><path d="M-9.01 -57.47 C-5.33 -64.97, -1.4 -76.37, -0.82 -81.09 M-9.01 -57.47 C-5.93 -65.64, -3.53 -75.34, -0.82 -81.09" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(600.0000476751809 464.07695776705145) rotate(0 -46.81803171100776 0)"><path d="M0 0 C-20.27 -0.67, -40.71 2.18, -93.64 0 M0 0 C-25.02 0.4, -50.26 0.42, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(600.0000476751809 464.07695776705145) rotate(0 -46.81803171100776 0)"><path d="M-70.08 -8.37 C-75.06 -7.44, -80.26 -2.77, -93.64 0 M-70.08 -8.37 C-75.94 -5.62, -82 -3.31, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(600.0000476751809 464.07695776705145) rotate(0 -46.81803171100776 0)"><path d="M-70.21 8.73 C-75.25 5.94, -80.42 6.89, -93.64 0 M-70.21 8.73 C-76 6.8, -82.03 4.44, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(223.21582392673503 426.1468489798011) rotate(0 137.79660041333216 30)"><path d="M15 0 C79.15 2.69, 146.89 0.8, 260.59 0 M260.59 0 C268.78 1.01, 276.68 3.24, 275.59 15 M275.59 15 C274.86 22.99, 275.73 27.4, 275.59 45 M275.59 45 C275.01 54.3, 271.23 61.17, 260.59 60 M260.59 60 C203.82 59.21, 144.45 60.16, 15 60 M15 60 C5.6 61.15, -0.43 56.74, 0 45 M0 45 C-1.22 37.74, -0.59 27.78, 0 15 M0 15 C-0.39 5.65, 3.66 -0.53, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(256.5124243400672 431.1468489798011) rotate(0 104.5 25)"><text x="104.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(b*s, hidden_size)</text><text x="104.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 1024)</text></g><g stroke-linecap="round" transform="translate(24.426508715323735 492.81994122343656) rotate(0 610.0744624247009 254.5030395333329)"><path d="M32 0 C268.38 -1.88, 504.48 -0.55, 1188.15 0 M32 0 C437.66 -3.88, 842.41 -3.85, 1188.15 0 M1188.15 0 C1208.7 -0.63, 1221.17 10.27, 1220.15 32 M1188.15 0 C1210.21 -2.23, 1219.21 10.6, 1220.15 32 M1220.15 32 C1222.42 147.94, 1223.08 261.39, 1220.15 477.01 M1220.15 32 C1221.35 159.39, 1221.61 288.02, 1220.15 477.01 M1220.15 477.01 C1219.76 497.37, 1209 507.97, 1188.15 509.01 M1220.15 477.01 C1217.97 496.26, 1210.96 507.6, 1188.15 509.01 M1188.15 509.01 C893.23 513.84, 598.13 513.38, 32 509.01 M1188.15 509.01 C780.84 511.66, 374.29 511.61, 32 509.01 M32 509.01 C11.19 510.37, 1.22 499.48, 0 477.01 M32 509.01 C12.26 508.13, 2.27 498.69, 0 477.01 M0 477.01 C0.95 369.8, 1.27 262.87, 0 32 M0 477.01 C0.66 340.65, 0.35 204.91, 0 32 M0 32 C-1.24 10.35, 12.55 1.09, 32 0 M0 32 C2.26 11.87, 12.08 0.61, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(53.857230545504876 403.8453196013536) rotate(0 76.99996948242188 35)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Model</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Qwen3Model</text></g><g stroke-linecap="round"><g transform="translate(604.4432933524488 343.2242790897383) rotate(0 -46.81803171100776 0)"><path d="M0 0 C-34.94 1.87, -66.32 0.71, -93.64 0 M0 0 C-32.34 -0.07, -63.98 0.44, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(604.4432933524488 343.2242790897383) rotate(0 -46.81803171100776 0)"><path d="M-70.09 -8.4 C-79.86 -3.55, -86.01 -1.68, -93.64 0 M-70.09 -8.4 C-78.7 -6.11, -86.6 -2.76, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(604.4432933524488 343.2242790897383) rotate(0 -46.81803171100776 0)"><path d="M-70.2 8.71 C-79.8 7.4, -85.92 3.11, -93.64 0 M-70.2 8.71 C-78.75 5.19, -86.61 2.75, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(225.4374043914376 307.2583789707344) rotate(0 137.79660041333216 30)"><path d="M15 0 C69.66 -0.44, 125.24 -0.5, 260.59 0 M260.59 0 C269.36 -0.74, 276.86 6.52, 275.59 15 M275.59 15 C276.68 22.85, 274.88 30.82, 275.59 45 M275.59 45 C275.39 54.02, 269.93 61.07, 260.59 60 M260.59 60 C208.3 61.68, 154.58 61.25, 15 60 M15 60 C4.35 58.77, 1.85 53.96, 0 45 M0 45 C1.37 34.59, 0.84 21.56, 0 15 M0 15 C-0.52 6.2, 3.27 -0.38, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(258.73400480476977 312.2583789707344) rotate(0 104.5 25)"><text x="104.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(b*s, hidden_size)</text><text x="104.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 1024)</text></g><g stroke-linecap="round" transform="translate(546.7793033357741 244.1297688094869) rotate(0 61.94324122031577 28.369398955383417)"><path d="M14.18 0 C37.25 -1.75, 56.45 -1.35, 109.7 0 M14.18 0 C41.34 0.35, 66.48 -0.82, 109.7 0 M109.7 0 C119.89 1.66, 125.35 3.67, 123.89 14.18 M109.7 0 C121.02 -1.56, 124.18 6.96, 123.89 14.18 M123.89 14.18 C125.75 24.17, 122.11 32, 123.89 42.55 M123.89 14.18 C123.39 24.71, 123.89 34.23, 123.89 42.55 M123.89 42.55 C122.8 52.62, 120.02 58.32, 109.7 56.74 M123.89 42.55 C123.98 53.98, 120.5 54.72, 109.7 56.74 M109.7 56.74 C87.29 55.02, 60.13 56.62, 14.18 56.74 M109.7 56.74 C80.36 57.06, 52.61 57.81, 14.18 56.74 M14.18 56.74 C6.02 55.83, -0.87 50.8, 0 42.55 M14.18 56.74 C5.02 56.81, 1.21 49.72, 0 42.55 M0 42.55 C-1.15 35.04, 1.63 29.36, 0 14.18 M0 42.55 C0.2 32.66, -0.45 24.13, 0 14.18 M0 14.18 C-1.67 5.12, 5.17 0.73, 14.18 0 M0 14.18 C0.92 2.45, 6.82 -1.23, 14.18 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(570.22254455609 259.9991677648702) rotate(0 38.5 12.5)"><text x="38.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">lm_head</text></g><g stroke-linecap="round" transform="translate(680.9325351170701 140.74095338297025) rotate(0 289.87995571686275 117.5)"><path d="M32 0 C212.61 -0.75, 393.67 0.14, 547.76 0 M547.76 0 C567.47 1.02, 579.37 9.62, 579.76 32 M579.76 32 C579.58 71.72, 581.35 112.47, 579.76 203 M579.76 203 C579.85 224.62, 570.89 234.13, 547.76 235 M547.76 235 C432.45 233.29, 317.59 232.28, 32 235 M32 235 C9.84 233.96, -1.98 224.5, 0 203 M0 203 C0.65 145.58, -1.01 91.13, 0 32 M0 32 C0.62 9.78, 8.71 -0.33, 32 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(690.3124908339328 145.74095338297025) rotate(0 280.5 112.5)"><text x="280.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ParallelLMHead</text><text x="280.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(num_embedding, embedding_dim)</text><text x="280.5" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(151936, 1024)</text><text x="280.5" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="280.5" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">本质为Linear layer</text><text x="280.5" y="142.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">本质操作logits = F.linear(x, self.weight)</text><text x="280.5" y="167.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">最后会dist.gather(logits, all_logits, 0); logits =</text><text x="280.5" y="192.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">torch.cat(all_logits, -1) if self.tp_rank == 0 else</text><text x="280.5" y="217.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">None 为使rank0 GPU拥有完整的logits</text></g><g transform="translate(35.85551339203522 498.28608626372466) rotate(0 255.83174365258657 52.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">layers</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">nn.ModuleList([Qwen3DecoderLayer]</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">*num_hidden_layers==28)</text></g><g stroke-linecap="round"><g transform="translate(609.0190835448007 238.62000191050265) rotate(0 -0.5879922554519794 -56.026978851153785)"><path d="M0 0 C0.95 -27.46, -0.79 -50.52, -1.18 -112.05 M0 0 C-0.35 -36.64, -0.28 -74.55, -1.18 -112.05" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(609.0190835448007 238.62000191050265) rotate(0 -0.5879922554519794 -56.026978851153785)"><path d="M7.78 -88.71 C6.97 -95.43, 3.42 -97.82, -1.18 -112.05 M7.78 -88.71 C4.6 -96.16, 2.1 -104.8, -1.18 -112.05" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(609.0190835448007 238.62000191050265) rotate(0 -0.5879922554519794 -56.026978851153785)"><path d="M-9.32 -88.42 C-6.15 -95.37, -5.71 -97.82, -1.18 -112.05 M-9.32 -88.42 C-6.85 -95.8, -3.71 -104.53, -1.18 -112.05" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(549.0007990526144 65.49235044413285) rotate(0 61.94324122031577 28.369398955383417)"><path d="M14.18 0 C41.33 -0.63, 65.39 -1.68, 109.7 0 M14.18 0 C35.52 -0.72, 54.23 0.27, 109.7 0 M109.7 0 C121 -1.5, 122.32 6.27, 123.89 14.18 M109.7 0 C117.56 -2.12, 125.97 4.9, 123.89 14.18 M123.89 14.18 C122.54 20.71, 122.71 29.26, 123.89 42.55 M123.89 14.18 C124.76 23.68, 124.64 30.74, 123.89 42.55 M123.89 42.55 C124.67 53.68, 118.31 55.01, 109.7 56.74 M123.89 42.55 C125.72 53.4, 118.46 55.36, 109.7 56.74 M109.7 56.74 C73.88 54.55, 36.15 57.87, 14.18 56.74 M109.7 56.74 C76.55 57.19, 41.04 56.88, 14.18 56.74 M14.18 56.74 C4.36 56.44, -1.61 53.51, 0 42.55 M14.18 56.74 C5.48 56.24, -0.81 53.16, 0 42.55 M0 42.55 C1.38 38.27, 1.99 29.47, 0 14.18 M0 42.55 C-0.86 31.61, 0.36 21.05, 0 14.18 M0 14.18 C1.85 5.42, 4.99 0.06, 14.18 0 M0 14.18 C-0.22 4.2, 5.52 -0.81, 14.18 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(572.4440402729304 81.36174939951616) rotate(0 38.5 12.5)"><text x="38.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">sampler</text></g><g stroke-linecap="round"><g transform="translate(595.556801997913 217.5664588785976) rotate(0 -46.81803171100776 0)"><path d="M0 0 C-26.41 -0.11, -56.82 -0.31, -93.64 0 M0 0 C-27.03 -1.41, -52.67 -0.84, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(595.556801997913 217.5664588785976) rotate(0 -46.81803171100776 0)"><path d="M-70.31 -9 C-75.49 -6.73, -84.66 -4.21, -93.64 0 M-70.31 -9 C-77.21 -7.53, -82.82 -4.39, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(595.556801997913 217.5664588785976) rotate(0 -46.81803171100776 0)"><path d="M-69.98 8.1 C-75.23 5.21, -84.51 2.56, -93.64 0 M-69.98 8.1 C-77.14 4.7, -82.84 2.96, -93.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(223.27996646705452 190.8479760623959) rotate(0 136.653738910821 42.5)"><path d="M21.25 0 C98.25 -2.07, 172.51 -3, 252.06 0 M252.06 0 C266.16 -0.75, 274.6 8.82, 273.31 21.25 M273.31 21.25 C272.15 37.46, 272.41 51.79, 273.31 63.75 M273.31 63.75 C273.01 77.98, 265.4 85.43, 252.06 85 M252.06 85 C187.94 85.22, 122.52 85.14, 21.25 85 M21.25 85 C7.31 85.46, -0.15 77.61, 0 63.75 M0 63.75 C1.38 51.27, 0.79 41.01, 0 21.25 M0 21.25 C0.07 8.36, 5.14 -1.85, 21.25 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(249.93370537787553 195.8479760623959) rotate(0 110 37.5)"><text x="110" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(named as logits)</text><text x="110" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, num_embedding)</text><text x="110" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 151936)</text></g><g stroke-linecap="round" transform="translate(684.3317003078264 52.24768611362674) rotate(0 182.2609371621753 36.14283970424117)"><path d="M18.07 0 C91.02 -1.17, 165.35 -0.29, 346.45 0 M346.45 0 C359.85 -1.67, 366.2 6.53, 364.52 18.07 M364.52 18.07 C362.96 33.57, 363.8 45.92, 364.52 54.21 M364.52 54.21 C363.38 65.06, 356.55 71.46, 346.45 72.29 M346.45 72.29 C270 72.77, 195.06 72.67, 18.07 72.29 M18.07 72.29 C6.27 72.78, -1.78 64.79, 0 54.21 M0 54.21 C-1.44 44.58, 0.73 32.83, 0 18.07 M0 18.07 C0.5 7.85, 6.48 -1.4, 18.07 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(766.0926374700018 63.39052581786791) rotate(0 100.5 25)"><text x="100.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sampler</text><text x="100.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Gumbel-Max 采样算法</text></g><g stroke-linecap="round"><g transform="translate(699.1641793924352 792.0099722203205) rotate(0 301.2142980666385 -1.762070906860231)"><path d="M0 0 C214.61 -1.24, 430.07 -2.39, 602.43 -3.52" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(699.1641793924352 792.0099722203205) rotate(0 301.2142980666385 -1.762070906860231)"><path d="M578.99 5.17 C585.89 2.76, 594.88 -0.07, 602.43 -3.52" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(699.1641793924352 792.0099722203205) rotate(0 301.2142980666385 -1.762070906860231)"><path d="M578.88 -11.93 C585.73 -8.23, 594.76 -4.95, 602.43 -3.52" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1313.3071549725598 402.2004383632079) rotate(0 720.2142715454098 466.0002735682896)"><path d="M32 0 C463.93 -1.07, 896.4 -0.26, 1408.43 0 M32 0 C436.85 3.92, 842.22 3.68, 1408.43 0 M1408.43 0 C1429.88 0.18, 1439.95 10.55, 1440.43 32 M1408.43 0 C1428.4 -1.47, 1442.39 9.77, 1440.43 32 M1440.43 32 C1443.07 270.05, 1443.1 507.18, 1440.43 900 M1440.43 32 C1437.08 269.13, 1436.78 506.86, 1440.43 900 M1440.43 900 C1441.59 920.88, 1431.2 930.35, 1408.43 932 M1440.43 900 C1438.52 921.49, 1431 931.46, 1408.43 932 M1408.43 932 C909.93 935.59, 410.57 934.56, 32 932 M1408.43 932 C978.04 927, 547.99 926.87, 32 932 M32 932 C11.46 931.75, 0.24 920.38, 0 900 M32 932 C12.05 930.71, 0.81 921.01, 0 900 M0 900 C-2.76 601.98, -3.19 305.2, 0 32 M0 900 C0.39 617.29, 0.17 333.67, 0 32 M0 32 C1.34 8.86, 10.64 -1.72, 32 0 M0 32 C2.25 12.28, 8.75 -0.44, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(1364.1645790273872 1067.6288179670028) rotate(0 69.00001525878906 46.999969482421875)"><path d="M23.5 0 C45.95 0.13, 70.45 1.11, 114.5 0 M23.5 0 C48.49 -1.48, 72.04 -0.43, 114.5 0 M114.5 0 C131.57 -0.28, 137.57 7.24, 138 23.5 M114.5 0 C129.09 0.31, 136.87 6.25, 138 23.5 M138 23.5 C137.4 36.15, 138.61 48.78, 138 70.5 M138 23.5 C138.14 38.35, 138.33 51.86, 138 70.5 M138 70.5 C137.93 86.63, 130.22 94.99, 114.5 94 M138 70.5 C136.52 85.94, 131.39 94.96, 114.5 94 M114.5 94 C88.43 96.16, 56.39 94.19, 23.5 94 M114.5 94 C90.25 94.69, 63.97 94.42, 23.5 94 M23.5 94 C5.89 94.31, -0.74 87.67, 0 70.5 M23.5 94 C9.98 92.04, -0.75 86.11, 0 70.5 M0 70.5 C1.46 57.35, -1.42 43.46, 0 23.5 M0 70.5 C0.35 60.48, 1.34 51.27, 0 23.5 M0 23.5 C1.71 8.64, 9.17 0.88, 23.5 0 M0 23.5 C-0.37 9.34, 8.69 -1.77, 23.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1389.1645942861762 1102.1287874494246) rotate(0 44 12.5)"><text x="44" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Q Linear</text></g><g stroke-linecap="round" transform="translate(1366.1646248037544 1163.128734043663) rotate(0 68.00003051757812 32.99999237060547)"><path d="M16.5 0 C46.47 0.79, 75.13 -2.09, 119.5 0 M16.5 0 C53.47 0.52, 89.26 0.17, 119.5 0 M119.5 0 C130.57 -1.6, 135.43 4.63, 136 16.5 M119.5 0 C132.76 -0.49, 134.43 6.8, 136 16.5 M136 16.5 C137.38 28.61, 136.53 39.55, 136 49.5 M136 16.5 C136.71 29.7, 136.79 43, 136 49.5 M136 49.5 C135.39 58.79, 130.23 64.13, 119.5 66 M136 49.5 C136.67 62.75, 132.76 64.24, 119.5 66 M119.5 66 C79.84 65.67, 41.65 67.92, 16.5 66 M119.5 66 C85.16 65.84, 48.52 65.73, 16.5 66 M16.5 66 C3.63 64.28, 0.02 59.52, 0 49.5 M16.5 66 C6 65.4, -2.02 62.65, 0 49.5 M0 49.5 C1.65 41.69, 0.11 32.79, 0 16.5 M0 49.5 C-0.5 40.21, -0.51 31.6, 0 16.5 M0 16.5 C1.42 3.68, 6.81 -0.87, 16.5 0 M0 16.5 C1.94 5.14, 3.21 2.15, 16.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1390.1646553213325 1183.6287264142684) rotate(0 44 12.5)"><text x="44" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">K Linear</text></g><g stroke-linecap="round" transform="translate(1367.1646095449653 1232.1287111554793) rotate(0 68.00003051757812 32.49996185302735)"><path d="M16.25 0 C36.67 0.56, 59.95 2.79, 119.75 0 M16.25 0 C50.91 -0.42, 83.49 -1.08, 119.75 0 M119.75 0 C129.9 1.99, 135.64 3.52, 136 16.25 M119.75 0 C130.64 1.92, 135.49 6.86, 136 16.25 M136 16.25 C135.97 24.13, 137.94 33.76, 136 48.75 M136 16.25 C136.34 22.48, 135.37 30.32, 136 48.75 M136 48.75 C134.83 60.92, 132.46 65.69, 119.75 65 M136 48.75 C137.95 59.78, 129.3 64.02, 119.75 65 M119.75 65 C82.98 64.72, 46.38 65.92, 16.25 65 M119.75 65 C87.01 66.23, 54.52 65.57, 16.25 65 M16.25 65 C5.58 66.34, -1.06 58.13, 0 48.75 M16.25 65 C7 63.26, -0.69 61.39, 0 48.75 M0 48.75 C-0.87 37.87, -0.1 23.39, 0 16.25 M0 48.75 C0.2 38.19, 0.09 27.46, 0 16.25 M0 16.25 C-0.09 5.52, 5.25 -1.25, 16.25 0 M0 16.25 C-0.31 7.05, 6.15 -0.23, 16.25 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1391.1646400625434 1252.1286730085067) rotate(0 44 12.5)"><text x="44" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">V Linear</text></g><g stroke-linecap="round" transform="translate(1508.5908080713548 1074.6290163312606) rotate(0 307.4307219883983 28.999982561383945)"><path d="M14.5 0 C184.09 -1.56, 354.6 -0.58, 600.36 0 M600.36 0 C610.34 -1.76, 616.55 6.64, 614.86 14.5 M614.86 14.5 C616.39 23.41, 616.14 28.74, 614.86 43.5 M614.86 43.5 C613.39 52.95, 610.11 59.57, 600.36 58 M600.36 58 C409.73 56.04, 218.5 57.37, 14.5 58 M14.5 58 C4.38 57.2, -1.81 53.76, 0 43.5 M0 43.5 C0.37 34.33, -0.21 20.94, 0 14.5 M0 14.5 C0.84 6.47, 2.96 1.58, 14.5 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1530.0219267882687 1083.6289988926444) rotate(0 285.9996032714844 20)"><text x="285.9996032714844" y="14" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(num_heads==num_attention_heads*head_dim==head_size, hidden_size)</text><text x="285.9996032714844" y="34" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(16*128==2048, 1024)</text></g><g stroke-linecap="round" transform="translate(1507.5908996240892 1158.628650120323) rotate(0 308.0021854370591 29.857177734375)"><path d="M14.93 0 C218.47 0.28, 422.52 -0.64, 601.08 0 M601.08 0 C610.46 -0.9, 614.2 6.14, 616 14.93 M616 14.93 C615.64 21.47, 615.55 27.85, 616 44.79 M616 44.79 C616.83 53.01, 612.43 60.91, 601.08 59.71 M601.08 59.71 C420.9 61.86, 239.97 61.09, 14.93 59.71 M14.93 59.71 C6.86 59.44, 1.32 55.53, 0 44.79 M0 44.79 C-0.79 38.55, 1.52 29.73, 0 14.93 M0 14.93 C0.56 4.22, 3.73 0.05, 14.93 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1516.3935001002108 1168.485827854698) rotate(0 299.1995849609375 20)"><text x="299.1995849609375" y="14" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(num_kv_heads==num_key_value_heads*head_dim==head_size, hidden_size)</text><text x="299.1995849609375" y="34" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(8*128==1024, 1024)</text></g><g stroke-linecap="round" transform="translate(1508.5909606592454 1234.6287874494246) rotate(0 307.4308963745591 25)"><path d="M12.5 0 C188.26 -0.65, 363.66 -0.79, 602.36 0 M602.36 0 C610.99 -0.44, 615.42 2.82, 614.86 12.5 M614.86 12.5 C615.93 21.65, 616.94 29.59, 614.86 37.5 M614.86 37.5 C615.87 46.05, 610.75 50.05, 602.36 50 M602.36 50 C372.24 50.91, 143.43 51.59, 12.5 50 M12.5 50 C2.5 51.63, -1 43.87, 0 37.5 M0 37.5 C2.08 29.39, -1.66 23.54, 0 12.5 M0 12.5 C-1.79 3.16, 2.58 1.38, 12.5 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1516.822272072867 1239.6287874494246) rotate(0 299.1995849609375 20)"><text x="299.1995849609375" y="14" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(num_kv_heads==num_key_value_heads*head_dim==head_size, hidden_size)</text><text x="299.1995849609375" y="34" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(8*128==1024, 1024)</text></g><g stroke-linecap="round" transform="translate(1348.1644525974211 1050.3432257516006) rotate(0 399.2143467494418 130.64267839704246)"><path d="M32 0 C180.24 -1.17, 328.6 -0.34, 766.43 0 M32 0 C236.12 2.63, 439.55 3.11, 766.43 0 M766.43 0 C788.52 -1.48, 796.44 12.51, 798.43 32 M766.43 0 C789.51 -1.33, 797.77 10.78, 798.43 32 M798.43 32 C798.13 103.34, 796.9 179.9, 798.43 229.29 M798.43 32 C796.86 77.18, 796 123.67, 798.43 229.29 M798.43 229.29 C796.57 249.87, 786.78 262.5, 766.43 261.29 M798.43 229.29 C800.2 252, 788.57 260.51, 766.43 261.29 M766.43 261.29 C609.69 258.92, 454.39 258.54, 32 261.29 M766.43 261.29 C577.7 262.71, 388.75 262.33, 32 261.29 M32 261.29 C9.25 262.61, -1.33 250.71, 0 229.29 M32 261.29 C10.36 262.91, 1.58 251.96, 0 229.29 M0 229.29 C1.02 178.49, -0.15 127.71, 0 32 M0 229.29 C-1.32 183.4, -1.86 136.57, 0 32 M0 32 C-0.78 12.36, 12.4 1.16, 32 0 M0 32 C-0.26 11.39, 9.8 -2.26, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(2166.304877982766 1055.2002073015453) rotate(0 278.8594678031309 125.85719517299106)"><path d="M32 0 C169.28 -0.08, 306.89 -0.69, 525.72 0 M525.72 0 C547.3 0.94, 558.61 11.18, 557.72 32 M557.72 32 C560.39 83.2, 557.73 137.46, 557.72 219.71 M557.72 219.71 C556.71 239.66, 546.88 251.64, 525.72 251.71 M525.72 251.71 C390.57 251.97, 256.41 252.11, 32 251.71 M32 251.71 C10.49 251.49, 0.53 241.04, 0 219.71 M0 219.71 C-1.12 156.19, -3.11 90.34, 0 32 M0 32 C0.37 11.48, 12.5 -1.14, 32 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(2183.664345785897 1081.0574024745365) rotate(0 261.5 100)"><text x="261.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Name:qkv_proj</text><text x="261.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Class:QKVParallelLinear</text><text x="261.5" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">((num_heads+2*num_kv_heads))*head_dim,</text><text x="261.5" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hidden_size)</text><text x="261.5" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(4096, 1024)</text><text x="261.5" y="142.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="261.5" y="167.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">本质为Q/K/V Linear拼接,同时是ColumnParallelLinear</text><text x="261.5" y="192.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">本质操作F.linear(x, self.weight, self.bias)</text></g><g stroke-linecap="round"><g transform="translate(2088.44505810321 1044.3001951217511) rotate(0 -0.7178823288646754 -8.343318415412853)"><path d="M0 0 C-0.21 -4.23, -1.72 -9.93, -1.44 -16.69 M0 0 C-0.55 -5.02, -1.05 -9.55, -1.44 -16.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2088.44505810321 1044.3001951217511) rotate(0 -0.7178823288646754 -8.343318415412853)"><path d="M1.93 -9.02 C1.04 -10.92, -0.51 -13.57, -1.44 -16.69 M1.93 -9.02 C0.88 -11.32, -0.14 -13.39, -1.44 -16.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2088.44505810321 1044.3001951217511) rotate(0 -0.7178823288646754 -8.343318415412853)"><path d="M-3.79 -8.65 C-2.97 -10.68, -2.81 -13.44, -1.44 -16.69 M-3.79 -8.65 C-3.17 -11.08, -2.53 -13.26, -1.44 -16.69" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1833.08211827993 955.4859390258754) rotate(0 264.08234957627894 32.21426827566961)"><path d="M16.11 0 C189.29 -2.23, 361.8 -1.36, 512.06 0 M512.06 0 C522.36 1.86, 529.87 6.45, 528.16 16.11 M528.16 16.11 C527.92 26.87, 528.44 41.34, 528.16 48.32 M528.16 48.32 C528.45 58.68, 524.08 64, 512.06 64.43 M512.06 64.43 C379.15 66.56, 245.24 65.41, 16.11 64.43 M16.11 64.43 C6.64 63.28, 1 60.9, 0 48.32 M0 48.32 C1.18 39.43, -0.79 29.96, 0 16.11 M0 16.11 C-1.29 6.41, 5.44 -1.38, 16.11 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1855.1644678562088 962.700207301545) rotate(0 242 25)"><text x="242" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">qkv(Intermediate results)</text><text x="242" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, ((num_heads+2*num_kv_heads))*head_dim)</text></g><g stroke-linecap="round"><g transform="translate(2085.6381232648514 945.2355561160167) rotate(0 -3.3991353733994174 -8.173508688638918)"><path d="M0 0 C-1.95 -4.72, -4.34 -10.9, -6.8 -16.35 M0 0 C-1.93 -3.61, -2.92 -7.96, -6.8 -16.35" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2085.6381232648514 945.2355561160167) rotate(0 -3.3991353733994174 -8.173508688638918)"><path d="M-0.73 -9.9 C-2.62 -11.67, -4.72 -14.18, -6.8 -16.35 M-0.73 -9.9 C-2.33 -11.3, -3.46 -13.07, -6.8 -16.35" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2085.6381232648514 945.2355561160167) rotate(0 -3.3991353733994174 -8.173508688638918)"><path d="M-6.3 -7.51 C-6.28 -10.1, -6.49 -13.41, -6.8 -16.35 M-6.3 -7.51 C-6.57 -9.46, -6.38 -11.8, -6.8 -16.35" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(2413.450129826075 943.6289008004288) rotate(0 21.485735212053328 13.07141985212047)"><text x="0" y="18.299987792968658" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20.91427176339275px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">拆分</text></g><g stroke-linecap="round" transform="translate(1550.7963516783698 868.0573065621476) rotate(0 165.22510208743927 30)"><path d="M15 0 C109.49 0.37, 204.83 0.25, 315.45 0 M315.45 0 C325.36 -0.4, 328.89 6.9, 330.45 15 M330.45 15 C328.27 25.04, 329.18 38.1, 330.45 45 M330.45 45 C328.69 56.62, 324.96 58.51, 315.45 60 M315.45 60 C207.94 60.6, 98.72 62.12, 15 60 M15 60 C4.53 59.54, 0.25 56.93, 0 45 M0 45 C-0.01 39.53, -0.2 32.3, 0 15 M0 15 C0.6 4.39, 3.77 0.53, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1578.521453765809 873.0573065621476) rotate(0 137.5 25)"><text x="137.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">q</text><text x="137.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, num_heads*head_dim)</text></g><g stroke-linecap="round" transform="translate(1896.5109861649755 867.4858431134869) rotate(0 168.08250652382344 30)"><path d="M15 0 C84.48 1.41, 154.88 2.53, 321.17 0 M321.17 0 C330.22 1.9, 337.94 4.63, 336.17 15 M336.17 15 C337.15 19.4, 334.86 28.95, 336.17 45 M336.17 45 C337.26 53.26, 329.69 61.1, 321.17 60 M321.17 60 C238.32 61.28, 158.38 60.24, 15 60 M15 60 C4.46 61.87, 0.18 54.96, 0 45 M0 45 C2.02 34.17, 0.63 24.88, 0 15 M0 15 C-1.27 6.5, 6.02 1.31, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1910.593492688799 872.4858431134869) rotate(0 154 25)"><text x="154" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">k</text><text x="154" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, num_kv_heads*head_dim)</text></g><g stroke-linecap="round" transform="translate(2243.93913906676 867.4858431134869) rotate(0 175.51100819793032 30)"><path d="M15 0 C113.85 -0.54, 213.57 -2.57, 336.02 0 M336.02 0 C347.63 1.32, 352.1 5.56, 351.02 15 M351.02 15 C353.19 23.79, 350.18 31.13, 351.02 45 M351.02 45 C352.65 53.92, 346.4 59.31, 336.02 60 M336.02 60 C264.97 58.87, 195.64 58.05, 15 60 M15 60 C3.24 59.59, -1.84 53.85, 0 45 M0 45 C0.06 39.67, -0.49 32.64, 0 15 M0 15 C-0.46 3.07, 6.64 0.07, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(2265.4501472646907 872.4858431134869) rotate(0 154 25)"><text x="154" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">v</text><text x="154" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, num_kv_heads*head_dim)</text></g><g stroke-linecap="round"><g transform="translate(2104.8786315001826 948.5626662174116) rotate(0 -182.12928699978715 -3.7891124386845547)"><path d="M-0.43 0.24 C-61.26 -1.35, -303.71 -6.98, -364.18 -8.35 M1.55 -0.68 C-59.51 -1.62, -304.24 -6.19, -365.09 -7.22" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2104.8786315001826 948.5626662174116) rotate(0 -182.12928699978715 -3.7891124386845547)"><path d="M-341.45 -15.35 C-349.64 -12.33, -359.99 -7.87, -365.09 -7.22 M-341.45 -15.35 C-346.92 -13.77, -354.41 -10.64, -365.09 -7.22" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2104.8786315001826 948.5626662174116) rotate(0 -182.12928699978715 -3.7891124386845547)"><path d="M-341.76 1.75 C-350 -1.49, -360.24 -3.3, -365.09 -7.22 M-341.76 1.75 C-347.14 -1.26, -354.55 -2.72, -365.09 -7.22" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(2099.078653296566 946.9320813393961) rotate(0 158.85987676266723 -4.758698251018814)"><path d="M-0.68 0.09 C52.17 -1.42, 263.53 -7.01, 316.72 -8.58 M1.16 -0.9 C54.41 -2.78, 266.09 -9.04, 318.91 -10.21" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2099.078653296566 946.9320813393961) rotate(0 158.85987676266723 -4.758698251018814)"><path d="M295.65 -1.04 C302.01 -5.04, 309.66 -4.59, 318.91 -10.21 M295.65 -1.04 C303.14 -3.3, 311.14 -6.43, 318.91 -10.21" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2099.078653296566 946.9320813393961) rotate(0 158.85987676266723 -4.758698251018814)"><path d="M295.2 -18.13 C301.75 -17.54, 309.52 -12.51, 318.91 -10.21 M295.2 -18.13 C302.97 -15.04, 311.12 -12.81, 318.91 -10.21" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1556.0979591543405 717.4480256580171) rotate(0 171.4287022181918 37.35713413783486)"><path d="M18.68 0 C79.71 2.19, 143.58 1.22, 324.18 0 M18.68 0 C113.78 -0.93, 209.05 -1.13, 324.18 0 M324.18 0 C337.52 -1.17, 343.02 4.46, 342.86 18.68 M324.18 0 C338.58 0.75, 342.74 5.68, 342.86 18.68 M342.86 18.68 C342.78 27.02, 343.47 33.76, 342.86 56.04 M342.86 18.68 C343.46 31.38, 341.79 42.84, 342.86 56.04 M342.86 56.04 C341.81 69.85, 337.49 75.72, 324.18 74.71 M342.86 56.04 C342.29 69.99, 338.24 74.68, 324.18 74.71 M324.18 74.71 C240.01 75.76, 155.04 77.39, 18.68 74.71 M324.18 74.71 C210.72 72.17, 95.98 73.11, 18.68 74.71 M18.68 74.71 C7.42 74.2, 0.02 67.46, 0 56.04 M18.68 74.71 C5.95 73.76, 0.87 68.87, 0 56.04 M0 56.04 C1.65 47.99, -1.84 35.25, 0 18.68 M0 56.04 C0.66 44.06, 0.31 29.96, 0 18.68 M0 18.68 C-1.35 7.87, 5.79 -0.96, 18.68 0 M0 18.68 C-1.71 6.67, 5.56 -1.46, 18.68 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1595.526844478001 724.805159795852) rotate(0 131.99981689453125 30)"><text x="131.99981689453125" y="14" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">q_norm</text><text x="131.99981689453125" y="34" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">RMSNorm eps=rms_num_eps=1e-06;</text><text x="131.99981689453125" y="54" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">γ weight(hidden_size==1024,)</text></g><g stroke-linecap="round" transform="translate(1909.240354173872 720.8050464448474) rotate(0 171.42870221819192 35)"><path d="M17.5 0 C92.79 -0.48, 171.87 1.05, 325.36 0 M17.5 0 C113.33 1.65, 207.77 1.04, 325.36 0 M325.36 0 C336.07 1.53, 344.01 6.05, 342.86 17.5 M325.36 0 C338.26 -2.23, 344.7 6.39, 342.86 17.5 M342.86 17.5 C341.3 28.79, 341.27 44.52, 342.86 52.5 M342.86 17.5 C341.81 26.94, 343.22 35.83, 342.86 52.5 M342.86 52.5 C341.05 66.1, 339.01 68.22, 325.36 70 M342.86 52.5 C341.34 65.5, 337.73 70.28, 325.36 70 M325.36 70 C256.72 70.72, 187.52 71.8, 17.5 70 M325.36 70 C255.35 69.23, 185.02 69.68, 17.5 70 M17.5 70 C5.2 68.18, 1.26 65.52, 0 52.5 M17.5 70 C5.04 70.4, 1.93 62.44, 0 52.5 M0 52.5 C0.36 37.43, 0.33 27.18, 0 17.5 M0 52.5 C-0.72 41.82, 0.13 32.78, 0 17.5 M0 17.5 C0.26 4.13, 4.23 0.52, 17.5 0 M0 17.5 C1.03 6.63, 8.06 1.99, 17.5 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1948.6692394975325 725.8050464448474) rotate(0 131.99981689453125 30)"><text x="131.99981689453125" y="14" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">k_norm</text><text x="131.99981689453125" y="34" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">RMSNorm eps=rms_num_eps=1e-06;</text><text x="131.99981689453125" y="54" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">γ weight(hidden_size==1024,)</text></g><g transform="translate(1330.9548753094746 741.5191577729723) rotate(0 110 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">if not self.qkv_bias</text></g><g stroke-linecap="round"><g transform="translate(2392.2659295199655 786.0193016415548) rotate(0 -0.750032819876651 -81.46760039378358)"><path d="M0 0 C-1.82 -45.75, -3.4 -93.97, -1.5 -162.94 M0 0 C0.51 -46.04, 0.32 -92.09, -1.5 -162.94" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2392.2659295199655 786.0193016415548) rotate(0 -0.750032819876651 -81.46760039378358)"><path d="M7.54 -139.63 C4.18 -144.55, 0.41 -152.02, -1.5 -162.94 M7.54 -139.63 C4.97 -146.15, 2.65 -152.72, -1.5 -162.94" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2392.2659295199655 786.0193016415548) rotate(0 -0.750032819876651 -81.46760039378358)"><path d="M-9.55 -139.27 C-7.92 -144.44, -6.71 -152.01, -1.5 -162.94 M-9.55 -139.27 C-7.29 -145.93, -4.77 -152.6, -1.5 -162.94" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1728.0976452592515 711.7335873558407) rotate(0 -0.5713762555803896 -13.71429443359375)"><path d="M0 0 C-0.43 -10.5, -0.52 -19.9, -1.14 -27.43 M0 0 C-0.15 -9.87, -0.36 -20.66, -1.14 -27.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1728.0976452592515 711.7335873558407) rotate(0 -0.5713762555803896 -13.71429443359375)"><path d="M4.57 -14.95 C2.42 -19.78, 0.5 -23.85, -1.14 -27.43 M4.57 -14.95 C2.61 -19.37, 0.63 -24.4, -1.14 -27.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1728.0976452592515 711.7335873558407) rotate(0 -0.5713762555803896 -13.71429443359375)"><path d="M-4.79 -14.2 C-3.43 -19.29, -1.83 -23.64, -1.14 -27.43 M-4.79 -14.2 C-3.25 -18.87, -1.73 -24.18, -1.14 -27.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(2081.2404326476444 718.5907999674479) rotate(0 -0.5713762555803896 -13.71429443359375)"><path d="M0 0 C-0.89 -8.63, -1.59 -17.22, -1.14 -27.43 M0 0 C-0.12 -7.26, -0.73 -14.72, -1.14 -27.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2081.2404326476444 718.5907999674479) rotate(0 -0.5713762555803896 -13.71429443359375)"><path d="M4.07 -14.73 C2.01 -18.63, 0.08 -22.52, -1.14 -27.43 M4.07 -14.73 C2.74 -18.05, 1.11 -21.48, -1.14 -27.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2081.2404326476444 718.5907999674479) rotate(0 -0.5713762555803896 -13.71429443359375)"><path d="M-5.32 -14.35 C-4.29 -18.4, -3.15 -22.41, -1.14 -27.43 M-5.32 -14.35 C-4.06 -17.73, -3.12 -21.27, -1.14 -27.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1557.240144910479 643.3051990327381) rotate(0 345.14295305524547 23.714250837053555)"><path d="M11.86 0 C185.11 0.48, 356.58 0.03, 678.43 0 M11.86 0 C258.5 -0.23, 504.94 -0.41, 678.43 0 M678.43 0 C685.36 -0.37, 690.69 2.12, 690.29 11.86 M678.43 0 C687.65 1.64, 690.18 3.74, 690.29 11.86 M690.29 11.86 C690.85 16.75, 689.99 25.73, 690.29 35.57 M690.29 11.86 C690.03 17.49, 690.16 24.24, 690.29 35.57 M690.29 35.57 C690.29 42.86, 684.4 46.15, 678.43 47.43 M690.29 35.57 C688.99 43.01, 687.92 49.45, 678.43 47.43 M678.43 47.43 C506.13 48.97, 334.59 48.59, 11.86 47.43 M678.43 47.43 C472.21 46.87, 266.26 46.58, 11.86 47.43 M11.86 47.43 C5.67 49.25, -0.68 42.17, 0 35.57 M11.86 47.43 C5.63 48.98, 1.91 44.21, 0 35.57 M0 35.57 C1.92 29.53, 2 22.4, 0 11.86 M0 35.57 C1.01 29.9, 0.53 25.77, 0 11.86 M0 11.86 C0.36 5.08, 2.76 -1.62, 11.86 0 M0 11.86 C-1.38 4.39, 2.38 -1.36, 11.86 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1645.8830979657246 654.5194498697916) rotate(0 256.5 12.5)"><text x="256.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">rotary_emb Rotary Position Embedding (RoPE)算法</text></g><g stroke-linecap="round"><g transform="translate(1905.1203709611343 639.4869369125707) rotate(0 -0.22919090502261952 -14.039076921406433)"><path d="M0 0 C0.28 -9.73, 0.33 -20.57, -0.46 -28.08 M0 0 C-0.24 -9.83, -0.56 -19.12, -0.46 -28.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1905.1203709611343 639.4869369125707) rotate(0 -0.22919090502261952 -14.039076921406433)"><path d="M4.36 -14.89 C2.94 -19.38, 1.38 -24.65, -0.46 -28.08 M4.36 -14.89 C2.71 -19.59, 0.98 -23.93, -0.46 -28.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1905.1203709611343 639.4869369125707) rotate(0 -0.22919090502261952 -14.039076921406433)"><path d="M-5.25 -14.88 C-3.23 -19.4, -1.37 -24.68, -0.46 -28.08 M-5.25 -14.88 C-3.68 -19.62, -2.19 -23.97, -0.46 -28.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1765.2404588055688 564.5908610026039) rotate(0 345.14295305524547 23.714250837053555)"><path d="M11.86 0 C147.22 -2.72, 283.07 -1.53, 678.43 0 M11.86 0 C232.62 2.28, 454.41 1.87, 678.43 0 M678.43 0 C687.97 0.28, 690.28 2.18, 690.29 11.86 M678.43 0 C685.16 -0.42, 690.07 5.37, 690.29 11.86 M690.29 11.86 C689.29 18.92, 690.29 21.57, 690.29 35.57 M690.29 11.86 C690.46 17.51, 691.23 24.49, 690.29 35.57 M690.29 35.57 C688.83 42.4, 687.76 46.43, 678.43 47.43 M690.29 35.57 C688.77 43.78, 685.05 48.01, 678.43 47.43 M678.43 47.43 C516.9 47.21, 353.83 46.85, 11.86 47.43 M678.43 47.43 C540.99 45.9, 404.36 45.68, 11.86 47.43 M11.86 47.43 C4.59 46.68, 1.07 42.89, 0 35.57 M11.86 47.43 C2.89 48.8, 0.37 45.36, 0 35.57 M0 35.57 C0.93 29.64, 1.16 19.72, 0 11.86 M0 35.57 C-0.6 28.94, 0.1 22.92, 0 11.86 M0 11.86 C-0.49 5.45, 2.63 0.94, 11.86 0 M0 11.86 C-0.79 6.07, 6.16 -1.39, 11.86 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1956.3834118608142 575.8051118396575) rotate(0 154 12.5)"><text x="154" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Name:atten; Class: Attention</text></g><g stroke-linecap="round"><g transform="translate(1903.472122974974 631.4869281932627) rotate(0 -189.94363356685324 0.24668096084809576)"><path d="M0 0 C-104.27 -0.08, -211.01 0.29, -379.89 0.49 M0 0 C-141.61 -0.11, -284.38 -0.03, -379.89 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1903.472122974974 631.4869281932627) rotate(0 -189.94363356685324 0.24668096084809576)"><path d="M-356.43 -8.14 C-361.38 -4.86, -370.39 -2.08, -379.89 0.49 M-356.43 -8.14 C-364.6 -5.48, -374.73 -2.43, -379.89 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1903.472122974974 631.4869281932627) rotate(0 -189.94363356685324 0.24668096084809576)"><path d="M-356.36 8.96 C-361.22 7.5, -370.25 5.55, -379.89 0.49 M-356.36 8.96 C-364.66 5.23, -374.82 1.89, -379.89 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1356.5868812019462 591.4478992280503) rotate(0 77.79660041333227 37.428545270647305)"><path d="M18.71 0 C63.95 0.95, 106.35 0.97, 136.88 0 M136.88 0 C148.04 0.53, 155.34 8.1, 155.59 18.71 M155.59 18.71 C157.75 28.5, 154.7 37.64, 155.59 56.14 M155.59 56.14 C153.74 70.26, 150.22 75.11, 136.88 74.86 M136.88 74.86 C108.61 74.8, 78.26 73.88, 18.71 74.86 M18.71 74.86 C6.07 75.16, 0.43 68.71, 0 56.14 M0 56.14 C-0.38 48.48, 0.16 35.27, 0 18.71 M0 18.71 C1.44 7.59, 8.02 -0.73, 18.71 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1366.8834816152785 603.8764444986977) rotate(0 67.5 25)"><text x="67.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">此些过程shape</text><text x="67.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">并未改变</text></g><g stroke-linecap="round"><g transform="translate(2093.186478443725 553.7727383913652) rotate(0 -0.22936529118351245 -12.324860961584989)"><path d="M0 0 C-0.12 -6.17, -1.1 -11.36, -0.46 -24.65 M0 0 C0.11 -8.63, -0.08 -17.65, -0.46 -24.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2093.186478443725 553.7727383913652) rotate(0 -0.22936529118351245 -12.324860961584989)"><path d="M4.25 -13.26 C3.19 -16.21, 1.59 -18.55, -0.46 -24.65 M4.25 -13.26 C2.71 -17.2, 0.97 -21.37, -0.46 -24.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2093.186478443725 553.7727383913652) rotate(0 -0.22936529118351245 -12.324860961584989)"><path d="M-4.18 -12.9 C-3.34 -15.92, -3.05 -18.34, -0.46 -24.65 M-4.18 -12.9 C-2.63 -16.93, -1.28 -21.23, -0.46 -24.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(2479.4438496729276 568.0194673084075) rotate(0 108.08224494458227 19.714311872209862)"><path d="M9.86 0 C50.97 0.58, 87.47 -0.39, 206.31 0 M206.31 0 C213.3 -0.77, 217.35 3.89, 216.16 9.86 M216.16 9.86 C215.02 15.53, 214.87 21.13, 216.16 29.57 M216.16 29.57 C217.97 36.48, 213.84 38.47, 206.31 39.43 M206.31 39.43 C154.51 39.37, 105.22 42.1, 9.86 39.43 M9.86 39.43 C3.44 37.69, -1.93 37.26, 0 29.57 M0 29.57 C1.66 23.8, 1.22 16.14, 0 9.86 M0 9.86 C-1.1 4.79, 4.98 -1.39, 9.86 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(2521.52609461751 575.2337791806174) rotate(0 66 12.5)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">use kv cache</text></g><g stroke-linecap="round" transform="translate(1762.954605010926 430.8763485863094) rotate(0 487.42863246372724 49.42860194614957)"><path d="M24.71 0 C388.13 1.32, 752.73 1.07, 950.14 0 M24.71 0 C219.49 -3.42, 413.86 -3.54, 950.14 0 M950.14 0 C967.65 -1.08, 974.02 6.67, 974.86 24.71 M950.14 0 C965.13 0, 973.63 10.22, 974.86 24.71 M974.86 24.71 C975.49 43.5, 976.06 62.59, 974.86 74.14 M974.86 24.71 C975.88 42.94, 975.05 61.63, 974.86 74.14 M974.86 74.14 C976.45 90.83, 967.16 99.38, 950.14 98.86 M974.86 74.14 C974.47 91.47, 968.14 99.14, 950.14 98.86 M950.14 98.86 C702.13 96.76, 455.75 97.4, 24.71 98.86 M950.14 98.86 C654.34 98.94, 358.96 98.99, 24.71 98.86 M24.71 98.86 C9.01 99.1, -1.09 88.97, 0 74.14 M24.71 98.86 C6.72 98.45, -0.84 89.53, 0 74.14 M0 74.14 C1.94 57.41, 2.03 40.13, 0 24.71 M0 74.14 C-1.18 64.44, 0.58 53.52, 0 24.71 M0 24.71 C1.63 8.15, 7.45 0.29, 24.71 0 M0 24.71 C2.12 9.77, 7.41 -0.32, 24.71 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1777.3832374746532 442.804950532459) rotate(0 473.0000000000001 37.5)"><text x="473" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Name:o_proj; Class: RowParallelLinear; (hidden_size, num_heads*head_size); (1024,2048)</text><text x="473" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">本质操作 y = F.linear(x, self.weight, self.bias if self.tp_rank == 0 else None)</text><text x="473" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">最后会dist.all_reduce(y)使得全部GPU都获得完整的Attention输出作为下一个层的输入</text></g><g stroke-linecap="round"><g transform="translate(2076.326975673203 543.5084508463977) rotate(0 -189.94363356685324 0.24668096084809576)"><path d="M0 0 C-126.63 2.33, -256.08 3.23, -379.89 0.49 M0 0 C-90.25 0.81, -181.75 -0.01, -379.89 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2076.326975673203 543.5084508463977) rotate(0 -189.94363356685324 0.24668096084809576)"><path d="M-356.4 -8.08 C-362.71 -4.84, -373.69 -0.74, -379.89 0.49 M-356.4 -8.08 C-361.27 -5.23, -368.16 -4.74, -379.89 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2076.326975673203 543.5084508463977) rotate(0 -189.94363356685324 0.24668096084809576)"><path d="M-356.39 9.02 C-362.65 6.52, -373.64 4.87, -379.89 0.49 M-356.39 9.02 C-361.16 7.79, -368.05 4.2, -379.89 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1356.0152433671246 522.3050944010416) rotate(0 163.51088612761794 30)"><path d="M15 0 C82.35 2.83, 150.46 1.94, 312.02 0 M312.02 0 C321.69 -0.2, 328.19 6.28, 327.02 15 M327.02 15 C328.1 22.04, 326.92 26.56, 327.02 45 M327.02 45 C325.19 56.78, 322.07 61.58, 312.02 60 M312.02 60 C220.03 59.61, 131.47 58.39, 15 60 M15 60 C4.15 59.65, -0.65 54.3, 0 45 M0 45 C1.54 33.46, 0.62 23.99, 0 15 M0 15 C0.41 5.54, 3.8 -1.94, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1371.0261294947425 527.3050944010416) rotate(0 148.5 25)"><text x="148.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(named as o)</text><text x="148.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, num_heads, head_size)</text></g><g stroke-linecap="round" transform="translate(1554.0154933206218 796.2859453473769) rotate(0 165.22510208743927 30)"><path d="M15 0 C84.66 0.11, 155.85 -0.31, 315.45 0 M315.45 0 C326.84 -1.04, 331.33 6.93, 330.45 15 M330.45 15 C332.2 25.54, 329.9 37.3, 330.45 45 M330.45 45 C331.14 54.78, 326.64 60.23, 315.45 60 M315.45 60 C206.85 57.74, 98.62 58.8, 15 60 M15 60 C4.71 61.04, 0.39 55.5, 0 45 M0 45 C-0.59 39.76, 0.35 31.88, 0 15 M0 15 C0.3 6.61, 3.66 1.46, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1576.240595408061 801.2859453473769) rotate(0 143 25)"><text x="143" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">q</text><text x="143" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, num_heads, head_dim)</text></g><g stroke-linecap="round" transform="translate(1904.3008762726301 798.571668352399) rotate(0 171.51102563654695 30)"><path d="M15 0 C104.14 2.19, 191.4 2.74, 328.02 0 M328.02 0 C338.54 1.22, 341.41 6.3, 343.02 15 M343.02 15 C342.86 21.28, 342.97 28.75, 343.02 45 M343.02 45 C342.26 54.39, 338.43 59.31, 328.02 60 M328.02 60 C207.77 61.74, 87.42 60.55, 15 60 M15 60 C4.08 61.28, 0.46 56.81, 0 45 M0 45 C-1.86 37.62, -1.06 30.66, 0 15 M0 15 C0.4 5.53, 3.26 -1.96, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1916.311901909177 803.571668352399) rotate(0 159.5 25)"><text x="159.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">k</text><text x="159.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, num_kv_heads, head_dim)</text></g><g stroke-linecap="round" transform="translate(2255.7296220873627 798.5717555454794) rotate(0 175.51100819793032 30)"><path d="M15 0 C121.75 -0.19, 227.72 -0.51, 336.02 0 M336.02 0 C344.89 -0.42, 351.26 5.52, 351.02 15 M351.02 15 C349.07 21.42, 352.59 29.2, 351.02 45 M351.02 45 C352.16 54.25, 344.31 58.99, 336.02 60 M336.02 60 C218.82 62.19, 102.54 60.59, 15 60 M15 60 C6.55 58.7, -1.36 56.48, 0 45 M0 45 C1.33 33.13, 0.2 19.87, 0 15 M0 15 C1.9 6.77, 5.66 0.25, 15 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(2271.7406302852933 803.5717555454794) rotate(0 159.5 25)"><text x="159.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">v</text><text x="159.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, num_kv_heads, head_dim)</text></g><g stroke-linecap="round"><g transform="translate(1498.585329124196 827.75350214462) rotate(0 24.964340087489518 -0.3247170930022776)"><path d="M0 0 C12.42 0.59, 23.84 -0.09, 49.93 -0.65 M0 0 C9.9 -0.62, 20.24 -0.06, 49.93 -0.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1498.585329124196 827.75350214462) rotate(0 24.964340087489518 -0.3247170930022776)"><path d="M26.58 8.19 C32.87 6.89, 38.13 4.31, 49.93 -0.65 M26.58 8.19 C31.12 5.94, 36.08 4.84, 49.93 -0.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1498.585329124196 827.75350214462) rotate(0 24.964340087489518 -0.3247170930022776)"><path d="M26.36 -8.89 C32.65 -6.23, 37.96 -4.85, 49.93 -0.65 M26.36 -8.89 C30.9 -7.68, 35.9 -5.32, 49.93 -0.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1332.8724792302198 797.428785051618) rotate(0 80.65374327047516 27.714276994977638)"><path d="M13.86 0 C66.69 -2.86, 116.71 -0.26, 147.45 0 M147.45 0 C156.71 1.63, 161.3 3.53, 161.31 13.86 M161.31 13.86 C161.34 19.86, 161.93 30.08, 161.31 41.57 M161.31 41.57 C160.88 51.84, 156.52 53.92, 147.45 55.43 M147.45 55.43 C99.65 54.45, 51.78 53.18, 13.86 55.43 M13.86 55.43 C5.87 53.63, 1.07 50.41, 0 41.57 M0 41.57 C-1.95 30.65, -0.1 20.74, 0 13.86 M0 13.86 C1.14 2.71, 4.92 0.31, 13.86 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1344.026222500695 812.6430620465956) rotate(0 69.5 12.5)"><text x="69.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">执行Transpose</text></g><g stroke-linecap="round"><g transform="translate(1505.4427161219633 519.1821607662719) rotate(0 0.3928940774446801 -12.324773768504599)"><path d="M0 0 C0.71 -10.21, 0.05 -18.17, 0.79 -24.65 M0 0 C0.28 -9.56, 0.25 -19.36, 0.79 -24.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1505.4427161219633 519.1821607662719) rotate(0 0.3928940774446801 -12.324773768504599)"><path d="M4.3 -12.83 C3.19 -17.82, 1.23 -21.42, 0.79 -24.65 M4.3 -12.83 C2.92 -17.4, 1.33 -22.12, 0.79 -24.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1505.4427161219633 519.1821607662719) rotate(0 0.3928940774446801 -12.324773768504599)"><path d="M-4.12 -13.34 C-1.96 -18.12, -0.66 -21.52, 0.79 -24.65 M-4.12 -13.34 C-2.21 -17.71, -0.51 -22.24, 0.79 -24.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1329.444047310577 447.71460396902876) rotate(0 209.7965916940243 21.428571428571388)"><path d="M10.71 0 C158.13 -2.08, 304.19 -1.09, 408.88 0 M408.88 0 C417.74 -1.43, 417.96 5.24, 419.59 10.71 M419.59 10.71 C417.62 18.83, 418.13 26.06, 419.59 32.14 M419.59 32.14 C418.98 38.82, 415 40.97, 408.88 42.86 M408.88 42.86 C295.88 41.94, 182.27 41.18, 10.71 42.86 M10.71 42.86 C2.47 44.35, 1.63 39.29, 0 32.14 M0 32.14 C-1.54 22.84, 1.44 15.29, 0 10.71 M0 10.71 C-1.86 4.42, 5.42 -1.89, 10.71 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1347.7406390046012 456.6431753976001) rotate(0 191.5 12.5)"><text x="191.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">reshape为(b*s, num_heads*head_size)</text></g><g transform="translate(1532.954671858954 496.0003008161268) rotate(0 88 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">o.flatten(1, -1)</text></g><g stroke-linecap="round"><g transform="translate(696.311732609279 563.3775920658074) rotate(0 301.7857179187592 -86.23438615062912)"><path d="M0 0 C133.15 -37.62, 267.2 -75.56, 603.57 -172.47" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(696.311732609279 563.3775920658074) rotate(0 301.7857179187592 -86.23438615062912)"><path d="M583.36 -157.76 C588.04 -161.86, 593.82 -164.57, 603.57 -172.47" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(696.311732609279 563.3775920658074) rotate(0 301.7857179187592 -86.23438615062912)"><path d="M578.63 -174.2 C584.49 -174.64, 591.31 -173.72, 603.57 -172.47" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1312.1689368648829 10) rotate(0 769.9286270141598 187.1431268964493)"><path d="M32 0 C512.42 -3.22, 992.37 -3.9, 1507.86 0 M32 0 C510.18 -5.6, 988.76 -5.43, 1507.86 0 M1507.86 0 C1531.02 0.87, 1540.26 9.18, 1539.86 32 M1507.86 0 C1527.65 0.16, 1542.08 10.54, 1539.86 32 M1539.86 32 C1541.07 119.28, 1540.6 203.18, 1539.86 342.29 M1539.86 32 C1537.65 111.64, 1537.89 191.62, 1539.86 342.29 M1539.86 342.29 C1538.75 362.39, 1530.99 374.88, 1507.86 374.29 M1539.86 342.29 C1537.76 364.31, 1528.82 373.09, 1507.86 374.29 M1507.86 374.29 C1120.43 371.13, 734.34 371.16, 32 374.29 M1507.86 374.29 C1053.77 377.3, 599.19 377.34, 32 374.29 M32 374.29 C10.44 373.95, 1.39 363.4, 0 342.29 M32 374.29 C11.48 376.55, 1.69 362.1, 0 342.29 M0 342.29 C-1.91 217.62, -0.1 96.09, 0 32 M0 342.29 C-0.19 233.42, -0.53 124.33, 0 32 M0 32 C1.87 9.17, 10.39 1.26, 32 0 M0 32 C1.38 11.12, 10.54 -1.25, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(1328.144981655968 271.8574996221639) rotate(0 71.28578186035156 21.28568376813621)"><path d="M10.64 0 C50.02 -0.55, 90.61 -0.71, 131.93 0 M10.64 0 C49.02 -1.93, 85.93 -2.04, 131.93 0 M131.93 0 C140 1.54, 143.99 5.01, 142.57 10.64 M131.93 0 C138.14 -0.88, 144.43 4.84, 142.57 10.64 M142.57 10.64 C142.55 15.7, 142.79 22.99, 142.57 31.93 M142.57 10.64 C143.12 17.35, 141.75 22.83, 142.57 31.93 M142.57 31.93 C143.49 39.05, 138.44 42.15, 131.93 42.57 M142.57 31.93 C144.53 39.68, 140.53 41.75, 131.93 42.57 M131.93 42.57 C87.96 43.83, 46.92 41.53, 10.64 42.57 M131.93 42.57 C107.06 41.2, 81.28 41.01, 10.64 42.57 M10.64 42.57 C1.63 41.73, -0.1 38.62, 0 31.93 M10.64 42.57 C1.66 41.09, -1.06 40.3, 0 31.93 M0 31.93 C-0.77 26.67, -1.58 22.64, 0 10.64 M0 31.93 C-0.66 24.72, -0.04 18.79, 0 10.64 M0 10.64 C1.51 3.81, 2.58 1.05, 10.64 0 M0 10.64 C-0.28 3.78, 2.55 0.99, 10.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1377.4307635163195 280.6431833903) rotate(0 22 12.5)"><text x="22" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">gate</text></g><g stroke-linecap="round" transform="translate(1325.8589534751645 317.7145640055344) rotate(0 71.28578186035156 17.5)"><path d="M8.75 0 C34.61 -0.54, 62.1 -1.46, 133.82 0 M8.75 0 C48.84 0.06, 89.06 -0.62, 133.82 0 M133.82 0 C140.67 0.55, 140.92 3.78, 142.57 8.75 M133.82 0 C141.48 -1.41, 141.03 4.32, 142.57 8.75 M142.57 8.75 C144.09 14.64, 141.92 23.72, 142.57 26.25 M142.57 8.75 C142.6 13.8, 143.32 18.59, 142.57 26.25 M142.57 26.25 C141.28 32.83, 138.89 36.51, 133.82 35 M142.57 26.25 C140.41 30.77, 140.9 34.51, 133.82 35 M133.82 35 C89.21 35.8, 45.64 38.13, 8.75 35 M133.82 35 C97.39 34.71, 61.28 35.74, 8.75 35 M8.75 35 C2.34 34.75, 0.33 31.15, 0 26.25 M8.75 35 C1.77 36.05, 1.34 33.98, 0 26.25 M0 26.25 C-0.07 21.98, 0.26 16.91, 0 8.75 M0 26.25 C0.08 19.67, -0.06 13.93, 0 8.75 M0 8.75 C0.78 2.43, 2.18 0.15, 8.75 0 M0 8.75 C-1.64 2.29, 1.47 1.27, 8.75 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1386.144735335516 322.7145640055344) rotate(0 11 12.5)"><text x="11" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">up</text></g><g stroke-linecap="round" transform="translate(1473.7142574877428 272.7146294003444) rotate(0 307.4307219883982 18.714272635323596)"><path d="M9.36 0 C218.76 1.58, 427.89 1.13, 605.5 0 M605.5 0 C609.85 -1.36, 615.77 2.72, 614.86 9.36 M614.86 9.36 C615.24 16.21, 616.2 21.44, 614.86 28.07 M614.86 28.07 C616.45 35.37, 611.6 39.39, 605.5 37.43 M605.5 37.43 C452.44 40.1, 299.38 38.98, 9.36 37.43 M9.36 37.43 C4.64 38.17, -0.02 36.06, 0 28.07 M0 28.07 C-1.22 22.59, 0.8 14.34, 0 9.36 M0 9.36 C1.65 2.59, 2.51 1.87, 9.36 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1539.144979476141 278.9289020356682) rotate(0 242 12.5)"><text x="242" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(intermediate_size, hidden_size)(3072, 1024)</text></g><g stroke-linecap="round" transform="translate(1473.7140831015822 317.2860536121191) rotate(0 307.4307219883983 18.714272635323653)"><path d="M9.36 0 C174.5 1.74, 340.53 0.74, 605.5 0 M605.5 0 C610.33 -0.12, 616.81 4.21, 614.86 9.36 M614.86 9.36 C616.16 12.65, 616.4 16.49, 614.86 28.07 M614.86 28.07 C614.38 33.94, 613.61 38.65, 605.5 37.43 M605.5 37.43 C473.92 39, 342.6 38.61, 9.36 37.43 M9.36 37.43 C3.41 39.26, -1.06 35.9, 0 28.07 M0 28.07 C1.61 22.01, -1.13 17.33, 0 9.36 M0 9.36 C-0.15 2.12, 2.75 -1.62, 9.36 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1539.1448050899805 323.5003262474427) rotate(0 242 12.5)"><text x="242" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(intermediate_size, hidden_size)(3072, 1024)</text></g><g stroke-linecap="round" transform="translate(1324.787601197681 257.92910257975313) rotate(0 390.0714547293526 52.35695975167414)"><path d="M26.18 0 C251.67 -0.54, 478.71 -0.36, 753.96 0 M26.18 0 C279.62 -1.68, 533.03 -1.86, 753.96 0 M753.96 0 C771.29 -1.46, 781.73 9.15, 780.14 26.18 M753.96 0 C772.04 0.54, 782.06 8.69, 780.14 26.18 M780.14 26.18 C781.07 45.04, 782 63.98, 780.14 78.54 M780.14 26.18 C780.9 45.14, 779.81 62.7, 780.14 78.54 M780.14 78.54 C778.28 94.67, 771.59 105.05, 753.96 104.71 M780.14 78.54 C782.35 93.99, 773.54 106.83, 753.96 104.71 M753.96 104.71 C506.6 102.29, 259.58 102.48, 26.18 104.71 M753.96 104.71 C584.17 101.88, 414.24 102.03, 26.18 104.71 M26.18 104.71 C9.86 103.61, 1.04 94.46, 0 78.54 M26.18 104.71 C7.92 102.56, -2.1 97.21, 0 78.54 M0 78.54 C0.65 59.46, 1.04 43.07, 0 26.18 M0 78.54 C-0.66 63.09, -0.73 46.88, 0 26.18 M0 26.18 C-1.05 9.54, 8.71 -0.64, 26.18 0 M0 26.18 C-1.2 7.27, 8.91 1.99, 26.18 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(2113.713908715421 250.57188124883805) rotate(0 366.8594329258988 55)"><path d="M27.5 0 C199.36 -0.92, 372.96 -0.2, 706.22 0 M706.22 0 C726.27 -0.05, 735.06 9, 733.72 27.5 M733.72 27.5 C733.43 44.96, 733.43 58.52, 733.72 82.5 M733.72 82.5 C733.83 100.54, 723.52 110.11, 706.22 110 M706.22 110 C469.48 111.21, 231.04 110.26, 27.5 110 M27.5 110 C9.87 108.65, -0.12 100.9, 0 82.5 M0 82.5 C1.84 62.76, -1.15 40.77, 0 27.5 M0 27.5 C0 7.5, 9.39 -0.47, 27.5 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(2120.5733416413195 255.57188124883805) rotate(0 360 50)"><text x="360" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Name: gate_up_proj; Class:MergedColumnParallelLinear</text><text x="360" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(2*intermediate_size, hidden_size); (6144, 1024);本质为Gate Linear</text><text x="360" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">和Up Linear拼接，同时是ColumnParallelLinear；本质操作F.linear(x,</text><text x="360" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">self.weight, self.bias)</text></g><g stroke-linecap="round"><g transform="translate(1694.2041384154904 256.3251523317956) rotate(0 -0.689266756566667 -14.038989728325987)"><path d="M0 0 C-0.5 -7.2, -0.78 -12.07, -1.38 -28.08 M0 0 C-0.4 -7.64, -0.12 -14.75, -1.38 -28.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1694.2041384154904 256.3251523317956) rotate(0 -0.689266756566667 -14.038989728325987)"><path d="M4.39 -15.26 C2.95 -18.75, 1.68 -20.64, -1.38 -28.08 M4.39 -15.26 C2.86 -18.87, 1.84 -22.1, -1.38 -28.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1694.2041384154904 256.3251523317956) rotate(0 -0.689266756566667 -14.038989728325987)"><path d="M-5.2 -14.55 C-4.5 -18.25, -3.62 -20.29, -1.38 -28.08 M-5.2 -14.55 C-4.28 -18.34, -2.86 -21.75, -1.38 -28.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1600.730694056956 159.71457708449634) rotate(0 90.1285536948543 30)"><path d="M15 0 C61.53 2.61, 108.46 2.3, 165.26 0 M15 0 C54.44 1.37, 94.99 1.06, 165.26 0 M165.26 0 C176.26 1.53, 181.18 3.85, 180.26 15 M165.26 0 C175.2 1.39, 180.72 5.88, 180.26 15 M180.26 15 C180.78 25.42, 181.14 33.5, 180.26 45 M180.26 15 C180.26 22.06, 180.69 28.49, 180.26 45 M180.26 45 C178.74 53.66, 176.47 59.19, 165.26 60 M180.26 45 C181.75 57.1, 176.55 60.35, 165.26 60 M165.26 60 C111.89 59.35, 61.25 58.82, 15 60 M165.26 60 C125.9 59.89, 86.03 59.43, 15 60 M15 60 C6.26 59.6, -0.41 55.48, 0 45 M15 60 C6.42 58.53, -1.34 54.3, 0 45 M0 45 C1.38 34.2, 1.1 22.77, 0 15 M0 45 C1 36.33, 0.48 28.87, 0 15 M0 15 C-0.18 3.34, 3.79 1.09, 15 0 M0 15 C-0.63 7.2, 3.83 -1.2, 15 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1635.8592477518105 164.71457708449634) rotate(0 55 25)"><text x="55" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">act_fn</text><text x="55" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">SiluAndMul</text></g><g stroke-linecap="round"><g transform="translate(1691.0886130429938 242.06090402371433) rotate(0 -52.80082002053621 0.2466809608481526)"><path d="M0 0 C-33.29 -1.62, -67.16 -0.35, -105.6 0.49 M0 0 C-32.69 0.06, -64.47 -1.64, -105.6 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1691.0886130429938 242.06090402371433) rotate(0 -52.80082002053621 0.2466809608481526)"><path d="M-82.37 -8.75 C-89.18 -7.15, -96.49 -3.06, -105.6 0.49 M-82.37 -8.75 C-90.18 -5.23, -97.1 -4.3, -105.6 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1691.0886130429938 242.06090402371433) rotate(0 -52.80082002053621 0.2466809608481526)"><path d="M-81.86 8.34 C-88.7 4.43, -96.17 3.01, -105.6 0.49 M-81.86 8.34 C-89.9 6.7, -96.97 2.48, -105.6 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1329.6188856964473 160.8573731921972) rotate(0 128.0974002808092 42.5)"><path d="M21.25 0 C94.07 2.44, 169.72 2, 234.94 0 M234.94 0 C248 -0.04, 255.09 8.14, 256.19 21.25 M256.19 21.25 C254.48 30.8, 255.24 41.51, 256.19 63.75 M256.19 63.75 C254.69 79.01, 247.32 83.01, 234.94 85 M234.94 85 C162.14 83.55, 88.48 83.04, 21.25 85 M21.25 85 C7.98 84.01, 0.02 79.21, 0 63.75 M0 63.75 C-0.06 46.38, 0.69 29.55, 0 21.25 M0 21.25 C0.24 6.55, 5.4 0.45, 21.25 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1347.7162859772566 165.8573731921972) rotate(0 110 37.5)"><text x="110" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(b*s,</text><text x="110" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">2*intermediate_size)</text><text x="110" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 6144)</text></g><g stroke-linecap="round" transform="translate(1796.5711387656438 146.21458144415033) rotate(0 514.2880217930865 41.785714285714334)"><path d="M20.89 0 C393.36 1.79, 765.23 0.89, 1007.68 0 M1007.68 0 C1022.64 -1.32, 1026.72 8.84, 1028.58 20.89 M1028.58 20.89 C1027.41 31.91, 1029.33 41.01, 1028.58 62.68 M1028.58 62.68 C1026.76 77.29, 1023.29 82.72, 1007.68 83.57 M1007.68 83.57 C704.27 86.28, 401.74 87.17, 20.89 83.57 M20.89 83.57 C7.67 83.05, -1.03 75.34, 0 62.68 M0 62.68 C-0.08 53.14, -0.66 41.73, 0 20.89 M0 20.89 C-1.99 8.14, 5.72 1.61, 20.89 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1947.8591605587303 163.00029572986455) rotate(0 363 25)"><text x="363" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">x, y = x.chunk(2, -1); return F.silu(x) * y</text><text x="363" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">即将输入x在最后一维上拆分为2份，一份输入进silu激活函数，结果与另一份相乘</text></g><g stroke-linecap="round"><g transform="translate(1689.2625735206539 161.46786560607052) rotate(0 -0.689266756566667 -16.896132585468877)"><path d="M0 0 C-0.63 -11.06, -0.74 -20.31, -1.38 -33.79 M0 0 C-0.19 -11.55, -1.49 -23.75, -1.38 -33.79" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1689.2625735206539 161.46786560607052) rotate(0 -0.689266756566667 -16.896132585468877)"><path d="M4.76 -18.03 C2.72 -23.56, 1.14 -27.54, -1.38 -33.79 M4.76 -18.03 C2.89 -23.36, 0.06 -29.23, -1.38 -33.79" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1689.2625735206539 161.46786560607052) rotate(0 -0.689266756566667 -16.896132585468877)"><path d="M-6.81 -17.78 C-5.38 -23.36, -3.5 -27.42, -1.38 -33.79 M-6.81 -17.78 C-4.65 -23.14, -3.46 -29.1, -1.38 -33.79" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1598.444927455394 58.000382922945164) rotate(0 90.1285536948543 30)"><path d="M15 0 C63.52 1.44, 114.23 -2.02, 165.26 0 M15 0 C62.54 0.15, 110.05 0.42, 165.26 0 M165.26 0 C175.22 1.4, 181.17 4.53, 180.26 15 M165.26 0 C177.32 2.28, 180.79 7.18, 180.26 15 M180.26 15 C180.18 24.31, 181.45 37.09, 180.26 45 M180.26 15 C180.27 25.52, 180.5 37.65, 180.26 45 M180.26 45 C179.15 56.84, 176.22 61.57, 165.26 60 M180.26 45 C181.49 55.39, 173.08 59.84, 165.26 60 M165.26 60 C121.14 57.63, 76.08 60.44, 15 60 M165.26 60 C130.63 59.93, 97.09 58.73, 15 60 M15 60 C6.01 58.43, -1.72 55.12, 0 45 M15 60 C3.14 58.57, -0.59 53.15, 0 45 M0 45 C-1.21 35.35, 0.98 30.31, 0 15 M0 45 C0.47 37.48, 0.8 31.75, 0 15 M0 15 C-0.09 4.56, 4.7 -1.05, 15 0 M0 15 C-1.68 4.59, 5.16 2.05, 15 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1639.0734811502484 75.50038292294516) rotate(0 49.5 12.5)"><text x="49.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">down_proj</text></g><g stroke-linecap="round" transform="translate(1795.999675316983 40.50027393159485) rotate(0 514.2880217930863 42.5)"><path d="M21.25 0 C238.04 0.42, 455.93 0.27, 1007.33 0 M1007.33 0 C1021.45 -0.46, 1030.41 7.7, 1028.58 21.25 M1028.58 21.25 C1026.67 34.86, 1026.95 49.69, 1028.58 63.75 M1028.58 63.75 C1028.88 76.04, 1020 86.06, 1007.33 85 M1007.33 85 C755.67 83.27, 502.93 81.97, 21.25 85 M21.25 85 C8.74 84.82, -0.05 78.95, 0 63.75 M0 63.75 C1.54 49.96, -0.11 31.03, 0 21.25 M0 21.25 C0.29 6.89, 7.31 1.46, 21.25 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1879.7876971100695 45.50027393159485) rotate(0 430.5 37.5)"><text x="430.5" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Class: RowParallelLinear; (hidden_size, intermediate_size); (1024, 3072)</text><text x="430.5" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">本质操作 y = F.linear(x, self.weight, self.bias if self.tp_rank == 0 else None)</text><text x="430.5" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">最后会dist.all_reduce(y)使得全部GPU都获得完整的Attention输出作为下一个层的输入</text></g><g stroke-linecap="round"><g transform="translate(1683.0886915167664 144.14374975303554) rotate(0 -44.80085489776832 0.2466809608481526)"><path d="M0 0 C-27.19 0.8, -59.33 1.43, -89.6 0.49 M0 0 C-28.85 1.17, -56.89 0.16, -89.6 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1683.0886915167664 144.14374975303554) rotate(0 -44.80085489776832 0.2466809608481526)"><path d="M-66.12 -8.09 C-72.19 -4.69, -83.16 -1.47, -89.6 0.49 M-66.12 -8.09 C-74.11 -4.88, -81.28 -3.34, -89.6 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1683.0886915167664 144.14374975303554) rotate(0 -44.80085489776832 0.2466809608481526)"><path d="M-66.1 9.02 C-72.07 6.93, -83.06 4.68, -89.6 0.49 M-66.1 9.02 C-74.08 6.83, -81.26 2.97, -89.6 0.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1328.476220378367 63.78601437523298) rotate(0 128.0974002808092 42.5)"><path d="M21.25 0 C72.46 3.27, 121.26 1.47, 234.94 0 M234.94 0 C248.58 -0.16, 256.12 7.65, 256.19 21.25 M256.19 21.25 C255.65 36.11, 255.22 51.03, 256.19 63.75 M256.19 63.75 C258.17 77.76, 249.1 83.02, 234.94 85 M234.94 85 C155.74 82.39, 73.62 82.56, 21.25 85 M21.25 85 C8.76 85, 0.17 77.73, 0 63.75 M0 63.75 C0.78 53.62, 0.6 41.62, 0 21.25 M0 21.25 C0.67 6.26, 5.49 1.25, 21.25 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1357.5736206591764 68.78601437523298) rotate(0 99 37.5)"><text x="99" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">t(b*s,</text><text x="99" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">intermediate_size)</text><text x="99" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">(b*s, 3072)</text></g></svg>