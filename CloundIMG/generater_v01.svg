<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2365.4956113140342 3461.6470604647507" width="2365.4956113140342" height="3461.6470604647507"><!-- svg-source:excalidraw --><metadata></metadata><defs><style class="style-fonts">
      @font-face { font-family: Comic Shanns; src: url(data:font/woff2;base64,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); }</style></defs><rect x="0" y="0" width="2365.4956113140342" height="3461.6470604647507" fill="#ffffff"></rect><g transform="translate(334.1234159249701 94.369952359541) rotate(0 115.49995422363281 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Prompt: "hello"</text></g><g stroke-linecap="round"><g transform="translate(436.71046367146175 140.369952359541) rotate(0 -0.4917845756757231 15.795918558207632)"><path d="M0 0 C-0.3 12.77, 0.22 25.88, -0.98 31.59 M0 0 C-0.32 8.55, -0.67 17.1, -0.98 31.59" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(436.71046367146175 140.369952359541) rotate(0 -0.4917845756757231 15.795918558207632)"><path d="M-6.02 16.61 C-3.99 22.75, -1.28 29.16, -0.98 31.59 M-6.02 16.61 C-4.75 20.69, -3.48 24.8, -0.98 31.59" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(436.71046367146175 140.369952359541) rotate(0 -0.4917845756757231 15.795918558207632)"><path d="M4.79 16.88 C2.54 22.92, 0.98 29.23, -0.98 31.59 M4.79 16.88 C3.19 20.94, 1.59 24.98, -0.98 31.59" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(293.41359611917665 195.1633001559165) rotate(0 229.69393722112386 16.839738141954513)"><text x="0" y="23.575633398736326" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="26.94358102712723px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">prompt_token_ids:[8,5,12,12,15]</text></g><g transform="translate(488.5556066457772 135.82434754698124) rotate(0 138.59994506835938 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">tokenizer.encode()</text></g><g stroke-linecap="round" transform="translate(278.8678305062109 182.96178947595627) rotate(0 243.0919752714541 27.197330945808545)"><path d="M13.6 0 C193.08 -0.8, 371.23 -0.97, 472.59 0 M13.6 0 C182.2 -0.13, 350.19 -0.17, 472.59 0 M472.59 0 C481.63 0.33, 487.07 3.97, 486.18 13.6 M472.59 0 C482.89 -2.01, 487.45 2.97, 486.18 13.6 M486.18 13.6 C487.16 18.81, 484.63 28.13, 486.18 40.8 M486.18 13.6 C485.82 24.81, 486.53 35.53, 486.18 40.8 M486.18 40.8 C484.9 51.26, 482.14 54.3, 472.59 54.39 M486.18 40.8 C485.41 50.46, 479.5 52.82, 472.59 54.39 M472.59 54.39 C362.2 55.86, 250.83 55.64, 13.6 54.39 M472.59 54.39 C337.65 54.82, 201.92 54.79, 13.6 54.39 M13.6 54.39 C3.01 53.52, -0.54 51.07, 0 40.8 M13.6 54.39 C2.81 56.54, -1.43 48.83, 0 40.8 M0 40.8 C-1.89 34.42, -2.17 27.47, 0 13.6 M0 40.8 C0.01 33.69, -0.12 27.34, 0 13.6 M0 13.6 C0.29 6.23, 3.02 -1.05, 13.6 0 M0 13.6 C-2.02 3.45, 3.25 1.91, 13.6 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(776.3586635236426 190.41697677792627) rotate(0 61.5999755859375 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence</text></g><g transform="translate(568.8826406695913 315.7228252335503) rotate(0 115.49995422363281 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">scheduler.add()</text></g><g stroke-linecap="round" transform="translate(536.5353795067971 521.0137679946312) rotate(0 199.48685740311066 34.570152486267034)"><path d="M17.29 0 C160.57 -5.42, 306.14 -5.88, 381.69 0 C396.24 2.69, 395.38 7.57, 398.97 17.29 C399.5 24.84, 397.61 28.16, 398.97 51.86 C395.43 64.46, 390.12 72.15, 381.69 69.14 C279.62 67.72, 176.27 71.78, 17.29 69.14 C7.33 70.11, 3.41 63.32, 0 51.86 C0.8 42.58, -2.48 37.81, 0 17.29 C1.29 2.21, 9.1 0.28, 17.29 0" stroke="none" stroke-width="0" fill="#a5d8ff"></path><path d="M17.29 0 C112.58 1.8, 208.42 0.84, 381.69 0 M17.29 0 C159.96 -0.55, 302.42 -0.92, 381.69 0 M381.69 0 C394.32 -1.36, 397.74 6.58, 398.97 17.29 M381.69 0 C391.46 1, 397.52 3.85, 398.97 17.29 M398.97 17.29 C399.61 29.65, 400.54 44.18, 398.97 51.86 M398.97 17.29 C399 30.27, 398.42 43.6, 398.97 51.86 M398.97 51.86 C397.11 62.01, 392.02 68.29, 381.69 69.14 M398.97 51.86 C400.97 63.48, 392.24 66.9, 381.69 69.14 M381.69 69.14 C296.71 70.87, 212.03 69.73, 17.29 69.14 M381.69 69.14 C257.96 68.52, 134.1 68.73, 17.29 69.14 M17.29 69.14 C4.52 68.25, -1.81 64.99, 0 51.86 M17.29 69.14 C4.69 67.22, -0.77 61.14, 0 51.86 M0 51.86 C0.3 44.54, -0.59 37.25, 0 17.29 M0 51.86 C-0.8 41.02, -0.93 30.76, 0 17.29 M0 17.29 C-1.11 7.42, 6.17 0.28, 17.29 0 M0 17.29 C-1.3 7.93, 5.61 0.57, 17.29 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(538.8022407287643 521.0138112322385) rotate(0 31.16977417810415 34.570174105069775)"><path d="M15.58 0 C28.39 -2.58, 43.46 3.03, 46.75 0 C53.55 1.81, 58.86 7.66, 62.34 15.58 C60.57 25.14, 58.81 42.15, 62.34 53.56 C59.25 66.95, 56.58 71.79, 46.75 69.14 C39.72 71.63, 28.49 69.57, 15.58 69.14 C8.6 69.08, -1.88 61.57, 0 53.56 C-2.97 46.23, 1.22 29.19, 0 15.58 C3.34 5.47, 3.46 -2.43, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C25.37 -0.64, 33 -0.19, 46.75 0 M15.58 0 C25.99 -0.79, 35.87 -0.59, 46.75 0 M46.75 0 C55.91 0.82, 60.81 6.06, 62.34 15.58 M46.75 0 C55.69 -1.91, 64.15 7.24, 62.34 15.58 M62.34 15.58 C63.66 27.61, 63.94 36.95, 62.34 53.56 M62.34 15.58 C62.1 29.89, 61.5 42.99, 62.34 53.56 M62.34 53.56 C61.15 63.1, 58.88 69.23, 46.75 69.14 M62.34 53.56 C61.37 61.71, 55.62 69.02, 46.75 69.14 M46.75 69.14 C37.31 69.18, 26.86 67.86, 15.58 69.14 M46.75 69.14 C38.01 70.26, 30.15 68.88, 15.58 69.14 M15.58 69.14 C3.39 70.75, -0.93 62.27, 0 53.56 M15.58 69.14 C4.43 66.9, -2.21 62.73, 0 53.56 M0 53.56 C-0.8 43.59, -0.06 34.93, 0 15.58 M0 53.56 C-0.59 38.48, -0.27 25.17, 0 15.58 M0 15.58 C0.41 5.47, 4.07 1.89, 15.58 0 M0 15.58 C-0.16 5.76, 7.4 0.76, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(601.7086773408893 521.5805481565332) rotate(0 31.16977417810415 34.570174105069775)"><path d="M15.58 0 C26.07 3.14, 26.9 2.26, 46.75 0 C53.67 2.46, 63.62 5.3, 62.34 15.58 C58.45 28.6, 58.91 42.47, 62.34 53.56 C61.78 66.6, 57.8 71.6, 46.75 69.14 C41.97 70.58, 37.45 69.55, 15.58 69.14 C3.31 66.76, -0.93 64.34, 0 53.56 C1.84 39.36, 3.89 32.55, 0 15.58 C-1.73 2.77, 7.94 1.06, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C28.42 0.05, 37.94 0.96, 46.75 0 M15.58 0 C24.61 -0.41, 31.91 0.68, 46.75 0 M46.75 0 C55.62 0.87, 61.08 3.53, 62.34 15.58 M46.75 0 C58.96 2.05, 62.3 5.58, 62.34 15.58 M62.34 15.58 C64.12 24.32, 63.98 36.1, 62.34 53.56 M62.34 15.58 C61.28 26.12, 61.62 37.6, 62.34 53.56 M62.34 53.56 C64.07 64.03, 56.3 67.2, 46.75 69.14 M62.34 53.56 C60.81 63.83, 57.87 69.37, 46.75 69.14 M46.75 69.14 C35.68 67.58, 22.18 68.57, 15.58 69.14 M46.75 69.14 C34.9 68.98, 23.39 70.24, 15.58 69.14 M15.58 69.14 C4.26 67.47, -0.67 61.99, 0 53.56 M15.58 69.14 C2.98 67.92, -1.17 64.08, 0 53.56 M0 53.56 C0.11 42.95, 1.84 30.26, 0 15.58 M0 53.56 C-0.22 44.98, 0.54 34.89, 0 15.58 M0 15.58 C-1.13 7.08, 5.06 0.49, 15.58 0 M0 15.58 C2.21 5.95, 7.46 -1.04, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(665.1815698328679 522.7140220051225) rotate(0 31.16977417810415 34.570174105069775)"><path d="M15.58 0 C18.82 1.39, 25.75 2.04, 46.75 0 C58.43 0.11, 62.86 3.4, 62.34 15.58 C58.58 26.62, 61.1 34.29, 62.34 53.56 C62.99 66.41, 53.69 72.02, 46.75 69.14 C38.19 69.23, 20.93 66.91, 15.58 69.14 C4.26 69.53, -0.71 61.05, 0 53.56 C3.09 39.19, -1.98 21.84, 0 15.58 C2.74 6.26, 1.64 2.01, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C24.53 0.89, 32.26 1.08, 46.75 0 M15.58 0 C21.59 0.62, 28.06 0.65, 46.75 0 M46.75 0 C55.88 -1.66, 63.91 6.98, 62.34 15.58 M46.75 0 C57.1 0.38, 61.51 6.64, 62.34 15.58 M62.34 15.58 C64.03 28.8, 62.54 40.37, 62.34 53.56 M62.34 15.58 C61.39 27.54, 62.85 40.38, 62.34 53.56 M62.34 53.56 C61.5 62, 55.82 69.04, 46.75 69.14 M62.34 53.56 C63.07 64.18, 58.99 70.17, 46.75 69.14 M46.75 69.14 C36.86 68.36, 29.91 67.41, 15.58 69.14 M46.75 69.14 C33.59 69.8, 21.76 68.17, 15.58 69.14 M15.58 69.14 C4.53 67.19, -1.92 62.89, 0 53.56 M15.58 69.14 C4.02 69.28, -0.3 63.06, 0 53.56 M0 53.56 C1.7 41.62, -1.04 30.94, 0 15.58 M0 53.56 C0.42 44.08, -0.35 35.28, 0 15.58 M0 15.58 C-0.14 5.69, 7.12 0.66, 15.58 0 M0 15.58 C2.27 4.16, 3.79 0.25, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(728.654721750485 523.8474526161045) rotate(0 31.16977417810415 34.570174105069775)"><path d="M15.58 0 C23.78 2.18, 40.22 -0.18, 46.75 0 C57.66 -1.79, 59.15 1.65, 62.34 15.58 C61.19 30.77, 62.41 43.1, 62.34 53.56 C58.88 66.83, 60.17 70.71, 46.75 69.14 C34.68 66.75, 25.44 69.52, 15.58 69.14 C4.48 66.25, 3.08 65.24, 0 53.56 C-2.36 43.48, 2.11 39.33, 0 15.58 C-3.56 7.21, 1.84 1.85, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C24.34 0.94, 32.47 0.97, 46.75 0 M15.58 0 C22.05 0.31, 29.42 -0.96, 46.75 0 M46.75 0 C58.72 1.78, 62.3 5.53, 62.34 15.58 M46.75 0 C56.31 1.45, 63.15 6.96, 62.34 15.58 M62.34 15.58 C62.51 23.87, 63.12 31.63, 62.34 53.56 M62.34 15.58 C62.98 24.41, 61.69 32.18, 62.34 53.56 M62.34 53.56 C61.01 63.84, 57.78 69.34, 46.75 69.14 M62.34 53.56 C64.18 64.97, 56.9 70.04, 46.75 69.14 M46.75 69.14 C40.99 67.56, 34.68 67.81, 15.58 69.14 M46.75 69.14 C38.33 68.56, 30.5 68.42, 15.58 69.14 M15.58 69.14 C3.27 68.08, -1.02 64.07, 0 53.56 M15.58 69.14 C4.89 68.25, -0.58 63.91, 0 53.56 M0 53.56 C-1.37 39.86, -1.26 28.57, 0 15.58 M0 53.56 C-0.64 39.96, -0.15 24.72, 0 15.58 M0 15.58 C1.92 5.86, 7.17 -0.9, 15.58 0 M0 15.58 C-1.4 5.44, 3.33 1.94, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(792.1278736681016 522.7139787675188) rotate(0 31.16977417810415 34.570174105069775)"><path d="M15.58 0 C27.78 -0.28, 37.93 -2.17, 46.75 0 C53.96 -3.55, 63.42 2.11, 62.34 15.58 C62.89 32.61, 58.78 47.59, 62.34 53.56 C65.37 65.51, 58.11 72.55, 46.75 69.14 C36.52 69.16, 27.44 65.88, 15.58 69.14 C8.28 70.43, -3.55 67.29, 0 53.56 C3.07 42.93, -3.23 32.2, 0 15.58 C-3.35 7.04, 4.83 -3.07, 15.58 0" stroke="none" stroke-width="0" fill="#b2f2bb"></path><path d="M15.58 0 C24.57 0.94, 35.71 -1.4, 46.75 0 M15.58 0 C25.58 -0.97, 37.62 0.76, 46.75 0 M46.75 0 C57.11 0.33, 61.61 6.45, 62.34 15.58 M46.75 0 C57.95 1.77, 60.87 6.8, 62.34 15.58 M62.34 15.58 C62.84 26.03, 60.95 39.03, 62.34 53.56 M62.34 15.58 C62.25 24.39, 62 35.1, 62.34 53.56 M62.34 53.56 C62.97 64.15, 58.75 70.03, 46.75 69.14 M62.34 53.56 C62.1 64.84, 55.39 68.14, 46.75 69.14 M46.75 69.14 C40.12 67.66, 28.84 67.1, 15.58 69.14 M46.75 69.14 C34.56 67.9, 22.08 68.35, 15.58 69.14 M15.58 69.14 C4.18 69.26, -0.26 63.17, 0 53.56 M15.58 69.14 C4.61 69.1, 0.33 65.89, 0 53.56 M0 53.56 C-0.74 43.92, 1.86 36.91, 0 15.58 M0 53.56 C0.15 41.89, 1.17 30.06, 0 15.58 M0 15.58 C1.97 4.29, 3.98 0.21, 15.58 0 M0 15.58 C-1.87 7.13, 6.91 -2.29, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(943.5210781151077 527.7730464488124) rotate(0 103.4549560546875 26.13343061098295)"><text x="0" y="18.293401427688064" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20.90674448878636px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">scheduler.waiting </text><text x="0" y="44.42683203867101" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20.90674448878636px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">deque</text></g><g transform="translate(256.691138761821 509.63319644889333) rotate(0 108.89993286132812 45)"><text x="0" y="31.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="36px" fill="#2f9e44" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">scheduler.</text><text x="0" y="76.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="36px" fill="#2f9e44" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">scheduler()</text></g><g transform="translate(269.5575976408219 1013.8897210317664) rotate(0 338.79986572265625 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Tuple[list[Sequence], bool]:seqs, is_prefill</text></g><g stroke-linecap="round" transform="translate(771.4385144878407 728.4939829402244) rotate(0 31.16977417810415 34.57017410506978)"><path d="M15.58 0 C24.91 0.74, 31.4 -3.37, 46.75 0 C60.03 3.03, 63.91 6.17, 62.34 15.58 C59.95 29.64, 62.72 44.84, 62.34 53.56 C59.45 67.03, 58.44 65.59, 46.75 69.14 C32.08 71.61, 23.33 65.31, 15.58 69.14 C7.21 65.79, 1.85 63.59, 0 53.56 C0.04 42.28, -2.17 35.46, 0 15.58 C1.18 2.18, 3.82 -0.62, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C24.75 -0.28, 30.68 -0.97, 46.75 0 M15.58 0 C26.26 0.46, 38.46 -0.28, 46.75 0 M46.75 0 C56.47 0.52, 60.47 3.82, 62.34 15.58 M46.75 0 C55.78 -0.97, 64.33 5.29, 62.34 15.58 M62.34 15.58 C61.87 26.01, 62.17 36.77, 62.34 53.56 M62.34 15.58 C61.54 28.24, 62.03 42.36, 62.34 53.56 M62.34 53.56 C60.84 65.81, 55.9 68.25, 46.75 69.14 M62.34 53.56 C60.26 65.79, 56.07 67.22, 46.75 69.14 M46.75 69.14 C37.39 67.82, 30.26 68.58, 15.58 69.14 M46.75 69.14 C38.75 69.98, 29.71 68.61, 15.58 69.14 M15.58 69.14 C3.44 68.2, -1.11 65.61, 0 53.56 M15.58 69.14 C5.67 69.46, -1.3 66.12, 0 53.56 M0 53.56 C0.57 44.39, -1 30.07, 0 15.58 M0 53.56 C1.05 40.76, 0.81 29, 0 15.58 M0 15.58 C1.37 5.91, 5.25 0.29, 15.58 0 M0 15.58 C-1.14 3.16, 2.93 0.69, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(553.537011621972 589.0206855937896) rotate(0 94.34789764280006 108.02820888673192)"><path d="M-0.76 -1 C2.59 33.5, -12.65 176.96, 19.18 207.48 C51.01 237.99, 161.8 186.21, 190.25 182.07 M1.04 1.09 C4.4 35.23, -12.68 175.52, 18.73 205.91 C50.13 236.31, 160.95 187.73, 189.47 183.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(553.537011621972 589.0206855937896) rotate(0 94.34789764280006 108.02820888673192)"><path d="M169.24 198.18 C172.04 196.6, 180 191.7, 189.47 183.49 M169.24 198.18 C176.05 194.17, 181.46 189.45, 189.47 183.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(553.537011621972 589.0206855937896) rotate(0 94.34789764280006 108.02820888673192)"><path d="M164.53 181.74 C168.45 183.86, 177.47 182.64, 189.47 183.49 M164.53 181.74 C172.77 182.9, 179.67 183.39, 189.47 183.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(829.7473283830242 876.0424496897301) rotate(0 55 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence B</text></g><g stroke-linecap="round" transform="translate(1034.925193727734 222.0967605411032) rotate(0 73.10735534858128 70.90032426115431)"><path d="M32 0 C61.04 4.45, 85.88 2.39, 114.21 0 C138.96 -0.06, 144.33 8.29, 146.21 32 C143.47 56.41, 147.66 71.1, 146.21 109.8 C149.55 131.41, 133.82 139.37, 114.21 141.8 C85.3 136.98, 54.2 139.98, 32 141.8 C7.6 139.48, 3.03 130.74, 0 109.8 C2.19 90.2, -0.36 76, 0 32 C-2.89 8.87, 8.19 -2.68, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C57.78 1, 82.58 -0.98, 114.21 0 M32 0 C62.08 0.3, 91.9 -0.65, 114.21 0 M114.21 0 C134.36 -0.85, 147.95 10.75, 146.21 32 M114.21 0 C134.58 -2.24, 144.69 10.55, 146.21 32 M146.21 32 C147.19 57.59, 147.07 82.08, 146.21 109.8 M146.21 32 C145.26 52.88, 145.38 71.45, 146.21 109.8 M146.21 109.8 C144.41 132.74, 134.62 140.13, 114.21 141.8 M146.21 109.8 C145.45 128.89, 133.34 140.58, 114.21 141.8 M114.21 141.8 C92.96 141.18, 73.22 141.98, 32 141.8 M114.21 141.8 C81.71 140.9, 50.41 142.2, 32 141.8 M32 141.8 C11.08 142.08, -1.13 133.02, 0 109.8 M32 141.8 C10.51 142.37, 2.21 131.89, 0 109.8 M0 109.8 C0.56 77.17, 2.03 49.27, 0 32 M0 109.8 C0.29 94.58, -0.36 78.79, 0 32 M0 32 C-0.99 8.9, 8.7 0.6, 32 0 M0 32 C-1.97 12.59, 10.31 1.69, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1042.0325490763153 242.99708480225752) rotate(0 66 50)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=0</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=-1</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[]</text></g><g transform="translate(966.3513878726607 275.65222166219144) rotate(0 27.5 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Block</text></g><g stroke-linecap="round" transform="translate(1183.9733512395362 221.47022591047505) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C57 -2.35, 84.83 0.42, 114.21 0 C134.83 -2.89, 149.3 11.96, 146.21 32 C145.78 45.23, 150.26 64.39, 146.21 109.8 C142.66 133.15, 132.19 143.65, 114.21 141.8 C93.4 140.45, 63.41 138.24, 32 141.8 C8.88 142.98, -3.01 129.75, 0 109.8 C-1.35 85.12, 1.58 62.24, 0 32 C1.56 11.87, 8.44 0.66, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C51.3 -0.87, 71.31 -2.07, 114.21 0 M32 0 C51.89 0.39, 69.62 -0.62, 114.21 0 M114.21 0 C134.22 -0.1, 146.85 10.87, 146.21 32 M114.21 0 C137.39 1.03, 145.97 11.57, 146.21 32 M146.21 32 C147.08 47.91, 147.74 65.56, 146.21 109.8 M146.21 32 C145.05 51.03, 145.18 70.75, 146.21 109.8 M146.21 109.8 C144.29 130.07, 134.53 141.92, 114.21 141.8 M146.21 109.8 C145.91 130.24, 134.96 141.76, 114.21 141.8 M114.21 141.8 C87.33 139.42, 61.59 140.07, 32 141.8 M114.21 141.8 C82.16 142.86, 51.17 142.16, 32 141.8 M32 141.8 C12.59 142.46, 1.97 130.23, 0 109.8 M32 141.8 C9.27 142.05, -1.87 133.07, 0 109.8 M0 109.8 C-1.16 82.02, 1.49 51.57, 0 32 M0 109.8 C-0.6 85.64, -0.47 61.71, 0 32 M0 32 C-0.31 12.14, 11.03 1.37, 32 0 M0 32 C-2.21 12.51, 12.6 1, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1191.0807065881174 242.37055017162936) rotate(0 66 50)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=1</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=-1</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[]</text></g><g stroke-linecap="round" transform="translate(1331.3215790228944 220.33680610889212) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C50.52 -3.05, 73.55 1.13, 114.21 0 C132 3.34, 146.49 8.94, 146.21 32 C143.72 52.1, 143.93 70.02, 146.21 109.8 C145.85 128.07, 133.23 144.83, 114.21 141.8 C88.67 141.9, 63.69 139.35, 32 141.8 C10.05 138.91, -1.8 128.66, 0 109.8 C1.38 93.46, -2.4 75.36, 0 32 C-2.91 9.67, 13.81 0.33, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C52.53 -0.42, 74.95 2.5, 114.21 0 M32 0 C56.35 0.75, 82.34 0.9, 114.21 0 M114.21 0 C137.15 0.89, 146 11.45, 146.21 32 M114.21 0 C133.79 -1, 145.59 12.05, 146.21 32 M146.21 32 C146.05 47.71, 148.55 66.1, 146.21 109.8 M146.21 32 C144.99 48.31, 145.45 65.74, 146.21 109.8 M146.21 109.8 C145.95 130.36, 135.04 141.77, 114.21 141.8 M146.21 109.8 C146.54 133.08, 133.81 140.6, 114.21 141.8 M114.21 141.8 C98.43 141.75, 79.6 140.22, 32 141.8 M114.21 141.8 C82.75 142.33, 50.34 141.55, 32 141.8 M32 141.8 C9.45 142.01, -1.62 132.82, 0 109.8 M32 141.8 C12.38 139.51, 1.15 128.91, 0 109.8 M0 109.8 C0.01 80.15, -2.05 50.51, 0 32 M0 109.8 C0.51 84.86, 0.85 59.14, 0 32 M0 32 C-1.92 12.27, 12.35 0.87, 32 0 M0 32 C0.62 12.84, 10.63 -1.2, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1338.4289343714756 241.23713037004643) rotate(0 66 50)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=2</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=-1</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[]</text></g><g transform="translate(1487.1704931510214 266.96846408248064) rotate(0 23.099990844726562 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">...</text></g><g stroke-linecap="round" transform="translate(1537.8926155514853 221.21674008739217) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C59.9 -3.1, 84.81 1.37, 114.21 0 C136.61 -3.56, 148.23 7.31, 146.21 32 C143.76 62.36, 145.68 83.53, 146.21 109.8 C143.61 129.35, 136.72 138.79, 114.21 141.8 C90.9 138.13, 68.51 141.06, 32 141.8 C7.12 143.36, 1.2 128.91, 0 109.8 C4.27 85.38, 4.53 57.36, 0 32 C-3.07 8.66, 7.71 2.2, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C61.85 -0.98, 95.48 0.98, 114.21 0 M32 0 C57.39 0.02, 82.22 -0.8, 114.21 0 M114.21 0 C135.01 1.21, 144.72 12.54, 146.21 32 M114.21 0 C134.12 -1.03, 144.14 12.52, 146.21 32 M146.21 32 C143.61 49.79, 144.5 70.42, 146.21 109.8 M146.21 32 C145.86 55.79, 146.26 80.47, 146.21 109.8 M146.21 109.8 C144.71 130.09, 133.79 140.86, 114.21 141.8 M146.21 109.8 C144.94 133.04, 136.02 142.12, 114.21 141.8 M114.21 141.8 C94.68 143.66, 74.81 143.72, 32 141.8 M114.21 141.8 C92.45 142.73, 73.06 140.89, 32 141.8 M32 141.8 C11.67 139.87, 1.37 131.85, 0 109.8 M32 141.8 C10.73 142.13, -1.14 129.1, 0 109.8 M0 109.8 C1.44 93.81, 1.24 78.81, 0 32 M0 109.8 C1.59 81.58, 1.02 53.43, 0 32 M0 32 C-0.03 9.62, 9.35 -0.52, 32 0 M0 32 C0.25 10.21, 8.82 1.97, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1544.9999709000665 229.61706434854648) rotate(0 66 62.5)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=cb-</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">3</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=-1</text><text x="66" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[]</text></g><g stroke-linecap="round" transform="translate(1686.9407730632872 220.590205456764) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C53.77 -4.69, 75.44 -4.48, 114.21 0 C137.39 -0.36, 143.15 8.35, 146.21 32 C143.45 60.1, 147.24 88.77, 146.21 109.8 C144.84 130.52, 132.65 140, 114.21 141.8 C91.66 143.54, 77.4 139.76, 32 141.8 C11.32 138.89, -1 134.28, 0 109.8 C-4.39 83.74, -4.28 63.87, 0 32 C1.42 9.01, 12.59 3.5, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C51.4 1.34, 71.3 -0.47, 114.21 0 M32 0 C59.61 0.96, 87.01 1.29, 114.21 0 M114.21 0 C134.3 -0.89, 144.41 12.27, 146.21 32 M114.21 0 C134.48 -1.92, 145.45 8.42, 146.21 32 M146.21 32 C145.92 47.6, 145.03 63.21, 146.21 109.8 M146.21 32 C145.57 54.69, 145.45 77.96, 146.21 109.8 M146.21 109.8 C145.1 132.79, 135.96 142.08, 114.21 141.8 M146.21 109.8 C144.92 133.31, 135.39 142.37, 114.21 141.8 M114.21 141.8 C80.75 141.39, 49.31 140.99, 32 141.8 M114.21 141.8 C83.13 140.01, 51.73 141.34, 32 141.8 M32 141.8 C10.73 142.09, -0.99 129.36, 0 109.8 M32 141.8 C8.4 142.49, -1.97 133.05, 0 109.8 M0 109.8 C0.79 85.76, 1.03 67.24, 0 32 M0 109.8 C-0.23 82.55, -0.87 56.08, 0 32 M0 32 C0.22 10.27, 9.06 1.71, 32 0 M0 32 C0.83 8.4, 12.8 0.18, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1694.0481284118684 228.99052971791832) rotate(0 66 62.5)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=cb-</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">2</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=-1</text><text x="66" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[]</text></g><g stroke-linecap="round" transform="translate(1834.2890008466454 219.45678565518108) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C50.38 1.02, 62.01 -0.94, 114.21 0 C138.58 -0.4, 143.09 8.06, 146.21 32 C145.29 50.86, 143.78 69.16, 146.21 109.8 C143.74 128.45, 136 138.25, 114.21 141.8 C86.65 137.98, 56.77 144.03, 32 141.8 C11 145.19, -2.92 128.06, 0 109.8 C2.57 89.14, 3.08 75.28, 0 32 C-2 8.16, 9.9 -2.26, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C64.04 -1.44, 93.65 -0.45, 114.21 0 M32 0 C61 -1.22, 90.35 0.04, 114.21 0 M114.21 0 C134.62 -1.67, 145.55 8.72, 146.21 32 M114.21 0 C133.34 -1.22, 145.04 10.81, 146.21 32 M146.21 32 C145.88 54.61, 147.61 75.13, 146.21 109.8 M146.21 32 C144.98 52.1, 145.74 70.67, 146.21 109.8 M146.21 109.8 C145.09 133.02, 135.41 142.29, 114.21 141.8 M146.21 109.8 C148.42 131.89, 137.82 140.76, 114.21 141.8 M114.21 141.8 C96.24 142.63, 72.91 142.14, 32 141.8 M114.21 141.8 C97.52 142.24, 80.27 141.21, 32 141.8 M32 141.8 C8.7 142.4, -1.72 132.8, 0 109.8 M32 141.8 C10.31 143.49, 0.42 132.71, 0 109.8 M0 109.8 C0.25 94.47, 1.27 78.03, 0 32 M0 109.8 C0.62 90.33, -0.29 72.11, 0 32 M0 32 C0.72 8.69, 12.52 0.15, 32 0 M0 32 C-1.11 9.11, 12.42 0.68, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1841.3963561952266 227.8571099163354) rotate(0 66 62.5)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=cb-</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">1</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=-1</text><text x="66" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[]</text></g><g stroke-linecap="round" transform="translate(949.916427825371 213.02918594041955) rotate(0 521.3860367718842 76.50777689435017)"><path d="M32 0 C251.45 0.46, 470.68 0.56, 1010.77 0 M32 0 C281.71 -3.48, 531.65 -3.54, 1010.77 0 M1010.77 0 C1030.18 -1.06, 1041.75 10.79, 1042.77 32 M1010.77 0 C1031.8 -0.89, 1042.19 10.63, 1042.77 32 M1042.77 32 C1042.48 58.22, 1042.59 86.85, 1042.77 121.02 M1042.77 32 C1042.39 67.04, 1042.89 100.43, 1042.77 121.02 M1042.77 121.02 C1044.69 143.01, 1034.08 152.11, 1010.77 153.02 M1042.77 121.02 C1041.37 142.59, 1030.24 154.95, 1010.77 153.02 M1010.77 153.02 C643.36 155.53, 277.77 155, 32 153.02 M1010.77 153.02 C702.6 149.67, 394.87 149.88, 32 153.02 M32 153.02 C10.35 154.49, 0.36 143.72, 0 121.02 M32 153.02 C8.46 154.86, 1.94 143.35, 0 121.02 M0 121.02 C-1.89 90.59, -1.36 63.03, 0 32 M0 121.02 C1.08 95.09, 1.64 71.21, 0 32 M0 32 C-0.96 9.32, 12.19 0.59, 32 0 M0 32 C-2.27 11.95, 8.52 1.18, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2007.0489710283407 179.24545465193194) rotate(0 146.29994201660156 35)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">CPU上的逻辑Block:</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">BlockManager.blocks</text></g><g transform="translate(1052.0250294431794 161.90218068874572) rotate(0 400.3998413085938 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">len(BlockManager.blocks) = config.num_kvcache_blocks</text></g><g transform="translate(946.8924372308586 385.58092582892755) rotate(0 504.6998596191406 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">max(len(token_ids)) = config.block_size 即一个block管理的tokens数量</text></g><g transform="translate(2008.670959866375 255.50732375999985) rotate(0 153.99993896484375 52.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">deque: free_block_id</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">set: used_blocl_id</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">管理blocks</text></g><g stroke-linecap="round" transform="translate(769.8650745417118 803.7934221294979) rotate(0 31.16977417810415 34.57017410506978)"><path d="M15.58 0 C21.95 -2.03, 29.22 0.9, 46.75 0 C53.6 1.56, 63.54 2.97, 62.34 15.58 C64.93 28, 65.18 36.83, 62.34 53.56 C59.27 61.94, 54.19 71.34, 46.75 69.14 C39.68 67.44, 23.08 68.67, 15.58 69.14 C2.94 71.9, 0.91 67, 0 53.56 C-0.44 39.28, 1.5 33.78, 0 15.58 C-0.82 6.63, 7.67 -1.32, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C21.53 -1.82, 30.32 -0.91, 46.75 0 M15.58 0 C24.87 0.1, 34.81 0.97, 46.75 0 M46.75 0 C55.64 -1.05, 60.58 4.26, 62.34 15.58 M46.75 0 C55.87 1.91, 62.81 5.51, 62.34 15.58 M62.34 15.58 C63.19 26.76, 63.36 36.06, 62.34 53.56 M62.34 15.58 C61.3 26.1, 62.85 33.94, 62.34 53.56 M62.34 53.56 C63.34 62.01, 58.51 69.85, 46.75 69.14 M62.34 53.56 C62.41 64.28, 56 67.1, 46.75 69.14 M46.75 69.14 C42.14 68.56, 35.67 69.24, 15.58 69.14 M46.75 69.14 C36.11 69.83, 24.06 70.34, 15.58 69.14 M15.58 69.14 C5.16 68.09, -1.32 63.43, 0 53.56 M15.58 69.14 C5.44 68.68, -1.85 65.91, 0 53.56 M0 53.56 C0.53 39.84, -0.98 29.57, 0 15.58 M0 53.56 C-0.56 41.56, 0.28 27.68, 0 15.58 M0 15.58 C-1.29 6.88, 4.97 -1.73, 15.58 0 M0 15.58 C-1.67 4.05, 5.95 -1.92, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(840.8165566668515 739.2807271214785) rotate(0 115.5 25)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">prompt: "abcde"</text><text x="0" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[1,2,3,4,5]</text></g><g transform="translate(841.0511569089279 804.5668142691736) rotate(0 154 25)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">prompt: "abcde fg"</text><text x="0" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[1,2,3,4,5,33,6,7]</text></g><g stroke-linecap="round" transform="translate(1168.8326807036653 618.0830420402164) rotate(0 58.76416173680809 103.662660736722)"><path d="M29.38 0 C43.25 -0.43, 58.63 0.36, 88.15 0 M29.38 0 C51.11 -0.16, 74.03 1.14, 88.15 0 M88.15 0 C108.14 0.28, 116.4 11.68, 117.53 29.38 M88.15 0 C107.58 0.57, 119.74 10.55, 117.53 29.38 M117.53 29.38 C117.07 86.98, 118.54 149.31, 117.53 177.94 M117.53 29.38 C118.96 59.49, 118.3 89.03, 117.53 177.94 M117.53 177.94 C116.53 195.76, 105.76 207.92, 88.15 207.33 M117.53 177.94 C115.55 199.45, 107.37 209.02, 88.15 207.33 M88.15 207.33 C71.05 208.44, 51.63 207.3, 29.38 207.33 M88.15 207.33 C64.29 206.76, 41.87 206.82, 29.38 207.33 M29.38 207.33 C8.19 209.04, 0.72 195.56, 0 177.94 M29.38 207.33 C11.93 207.5, -1.11 195.98, 0 177.94 M0 177.94 C0.68 120.19, 0.59 65.96, 0 29.38 M0 177.94 C0.85 145.16, 0.23 113.62, 0 29.38 M0 29.38 C0.65 8.12, 9.03 -0.34, 29.38 0 M0 29.38 C-1.85 8.65, 8.21 -1.71, 29.38 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1181.3968607510203 651.7457027769384) rotate(0 46.199981689453125 70)"><text x="46.199981689453125" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">BlockM</text><text x="46.199981689453125" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">anager</text><text x="46.199981689453125" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">.alloc</text><text x="46.199981689453125" y="129.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ate()</text></g><g stroke-linecap="round"><g transform="translate(1046.1149334628071 739.3428681960108) rotate(0 55.903959723585274 -27.520610023209574)"><path d="M0.17 1.02 C14.07 -1.02, 64.67 -2.72, 83.08 -12.23 C101.5 -21.74, 106 -49.01, 110.66 -56.06 M-1.2 0.5 C13.1 -1.38, 66.29 -1.77, 85.32 -11.02 C104.35 -20.28, 108.73 -47.45, 113 -55.04" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1046.1149334628071 739.3428681960108) rotate(0 55.903959723585274 -27.520610023209574)"><path d="M112.56 -30.04 C114.38 -38.41, 111.76 -45.52, 113 -55.04 M112.56 -30.04 C113.02 -36.23, 112.36 -41.75, 113 -55.04" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1046.1149334628071 739.3428681960108) rotate(0 55.903959723585274 -27.520610023209574)"><path d="M96.6 -36.17 C102.8 -42.89, 104.56 -48.31, 113 -55.04 M96.6 -36.17 C101.06 -40.95, 104.44 -44.91, 113 -55.04" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1030.7796779515545 793.5668142691736) rotate(0 62.75831389896638 -1.3567155501045676)"><path d="M-0.91 -0.63 C13.99 -2.18, 68.32 -9.34, 89.54 -8.29 C110.77 -7.24, 120.12 3.49, 126.42 5.68 M0.82 1.66 C16.06 0.78, 70.96 -7.42, 91.7 -7.05 C112.45 -6.68, 119.3 1.68, 125.31 3.86" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1030.7796779515545 793.5668142691736) rotate(0 62.75831389896638 -1.3567155501045676)"><path d="M106.25 1.01 C111.25 0.36, 117.35 1.88, 125.31 3.86 M106.25 1.01 C113.01 2.99, 120.79 3.41, 125.31 3.86" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1030.7796779515545 793.5668142691736) rotate(0 62.75831389896638 -1.3567155501045676)"><path d="M112.54 -10.57 C115.66 -7.63, 119.78 -2.47, 125.31 3.86 M112.54 -10.57 C116.91 -4.15, 122.28 0.7, 125.31 3.86" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1296.265083172217 617.422641651605) rotate(0 232.41570026455224 22.5)"><path d="M11.25 0 C110.11 1.38, 210.72 2.13, 453.58 0 M11.25 0 C150 -1.95, 289.3 -1.91, 453.58 0 M453.58 0 C463.05 -0.9, 463.61 3.96, 464.83 11.25 M453.58 0 C459.21 1.94, 466.55 1.46, 464.83 11.25 M464.83 11.25 C465.33 19.19, 464.9 26.01, 464.83 33.75 M464.83 11.25 C463.75 16.84, 464.45 21.5, 464.83 33.75 M464.83 33.75 C465.19 42.62, 459.16 46.6, 453.58 45 M464.83 33.75 C466.77 42.25, 461.7 47.18, 453.58 45 M453.58 45 C321.36 43.66, 189.46 42.75, 11.25 45 M453.58 45 C283.47 42.87, 112.19 42.5, 11.25 45 M11.25 45 C5.27 45.59, -1.98 42.37, 0 33.75 M11.25 45 C1.61 46.18, -0.23 39.29, 0 33.75 M0 33.75 C-1.92 27, -1.18 23.8, 0 11.25 M0 33.75 C-0.72 28.38, -0.6 23.27, 0 11.25 M0 11.25 C0.25 1.78, 4.62 0.67, 11.25 0 M0 11.25 C-1.42 4.17, 1.89 -0.64, 11.25 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1328.4808627824723 622.422641651605) rotate(0 200.19992065429688 17.5)"><text x="200.19992065429688" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">BlockManager.free_block_id</text></g><g stroke-linecap="round"><g transform="translate(1297.3610041772815 698.4456708946154) rotate(0 56.96165676395458 51.26605330543867)"><path d="M0.25 0.17 C8.75 -4.18, 31.26 -47.42, 50.39 -25.09 C69.52 -2.75, 104.03 107.62, 115.01 134.18 M-1.08 -0.79 C7.88 -5.53, 33.53 -49.36, 52.75 -26.61 C71.96 -3.87, 104.09 108.62, 114.2 135.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1297.3610041772815 698.4456708946154) rotate(0 56.96165676395458 51.26605330543867)"><path d="M98.71 116.03 C102.93 119.67, 108.33 125.45, 114.2 135.65 M98.71 116.03 C104.91 121.9, 108.35 128.83, 114.2 135.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1297.3610041772815 698.4456708946154) rotate(0 56.96165676395458 51.26605330543867)"><path d="M114.95 110.66 C115.25 115.64, 116.68 122.74, 114.2 135.65 M114.95 110.66 C115.93 118.33, 114.09 127, 114.2 135.65" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1277.8835963354506 839.6852471678377) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C48.26 1.34, 71.33 -2.58, 114.21 0 C133.04 -0.77, 143.96 13.43, 146.21 32 C145.51 55.6, 146.61 79.79, 146.21 109.8 C147.35 134.26, 134.73 143.24, 114.21 141.8 C80.65 140.68, 52.81 140.06, 32 141.8 C10.49 144.63, 3.21 131.93, 0 109.8 C1.62 89.58, -0.31 68.67, 0 32 C-1.98 8.99, 7.2 2.98, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C60.23 0.33, 85.18 2.38, 114.21 0 M32 0 C58.77 0.48, 85.95 1.21, 114.21 0 M114.21 0 C137.04 -1.99, 147.22 8.74, 146.21 32 M114.21 0 C137.12 0.82, 146.28 11, 146.21 32 M146.21 32 C146.13 49.75, 147.2 70.63, 146.21 109.8 M146.21 32 C145.4 61.87, 147.2 90.57, 146.21 109.8 M146.21 109.8 C146.75 133.03, 135.51 140.76, 114.21 141.8 M146.21 109.8 C144.7 130.54, 135.8 141.34, 114.21 141.8 M114.21 141.8 C94.19 143.95, 78.26 141.14, 32 141.8 M114.21 141.8 C94.11 142.6, 75.05 142.56, 32 141.8 M32 141.8 C10.47 140.1, -1.29 132.82, 0 109.8 M32 141.8 C10.41 139.81, -1.67 129.99, 0 109.8 M0 109.8 C0.31 82.31, -0.35 56.66, 0 32 M0 109.8 C0.34 92.59, -0.72 74.89, 0 32 M0 32 C-1.62 10.11, 12.41 0.19, 32 0 M0 32 C2.17 8.8, 8.71 -1.28, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1284.9909516840319 848.085571428992) rotate(0 66 62.5)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=0</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=1</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=1234</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[1</text><text x="66" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">,2,3,4]</text></g><g stroke-linecap="round" transform="translate(1427.1052949912607 839.6852471678359) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C58.55 0.05, 87.87 3.58, 114.21 0 C136.46 3.06, 146.27 8.77, 146.21 32 C147.04 54.79, 145.09 72.75, 146.21 109.8 C148.69 129.82, 136.16 138.55, 114.21 141.8 C92.51 143.81, 74.36 141.78, 32 141.8 C9.65 140, -3.1 132.05, 0 109.8 C-1.59 82.81, -3.07 62.15, 0 32 C3.03 12.95, 9.56 2.44, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C56.77 1.18, 79.31 -2.01, 114.21 0 M32 0 C58.29 -1.69, 83.58 -1.66, 114.21 0 M114.21 0 C136.92 0.71, 146.27 10.96, 146.21 32 M114.21 0 C134.4 -2.04, 143.95 11.36, 146.21 32 M146.21 32 C148.34 49.03, 148.23 63.41, 146.21 109.8 M146.21 32 C147.14 62.51, 146.85 90.61, 146.21 109.8 M146.21 109.8 C144.89 130.62, 135.77 141.4, 114.21 141.8 M146.21 109.8 C144.37 133.1, 136.38 139.53, 114.21 141.8 M114.21 141.8 C80.57 142.93, 50.22 139.43, 32 141.8 M114.21 141.8 C84.85 141.37, 55.05 143.06, 32 141.8 M32 141.8 C10.45 140.07, -1.45 130.14, 0 109.8 M32 141.8 C11.42 139.88, -0.88 130.74, 0 109.8 M0 109.8 C-1.1 92.96, -1.58 76.49, 0 32 M0 109.8 C-0.33 83.59, 1.35 58.02, 0 32 M0 32 C1.89 9.04, 8.96 -1.11, 32 0 M0 32 C-1.89 12.07, 11.57 -1.06, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1434.212650339842 848.0855714289902) rotate(0 66 62.5)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=1</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=-1</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[5</text><text x="66" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">,]</text></g><g transform="translate(941.3176733360553 430.5834736520625) rotate(0 216.29994201660156 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">设此案例中config.block_size=4</text></g><g transform="translate(837.3555428976596 700.512912210922) rotate(0 55 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence A</text></g><g stroke-linecap="round" transform="translate(1656.879645575126 846.2879664977919) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C45.94 -2.17, 69.04 -0.25, 114.21 0 C132.43 -2.61, 144.43 11.84, 146.21 32 C142.78 47.04, 143.2 62.99, 146.21 109.8 C146.67 127.59, 137.11 143, 114.21 141.8 C93.63 143.75, 75.39 144, 32 141.8 C7.75 138.73, -2 128.18, 0 109.8 C1.37 85.22, -2.55 51.12, 0 32 C-0.77 8.41, 13.43 0.91, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C48 0.39, 66.05 0.75, 114.21 0 M114.21 0 C136.26 0.06, 146.5 9.67, 146.21 32 M146.21 32 C143.73 50.12, 145.14 66.37, 146.21 109.8 M146.21 109.8 C146.58 132.5, 133.63 143.4, 114.21 141.8 M114.21 141.8 C84.53 141.99, 50 140.7, 32 141.8 M32 141.8 C10.15 142.02, -0.4 129.53, 0 109.8 M0 109.8 C1.58 79.95, -1.24 48.45, 0 32 M0 32 C1.52 11.26, 8.69 1.12, 32 0" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1663.9870009237072 854.6882907589462) rotate(0 66 62.5)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=0</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=1234</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[1</text><text x="66" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">,2,3,4]</text></g><g stroke-linecap="round"><g transform="translate(1746.9440149322984 999.0886150201005) rotate(0 -188.22297259405104 9.474853910657117)"><path d="M0.82 0.43 C-34.01 5.05, -145.39 27.91, -208.4 26.56 C-271.42 25.21, -349.02 -2.2, -377.27 -7.67" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1746.9440149322984 999.0886150201005) rotate(0 -188.22297259405104 9.474853910657117)"><path d="M-352.38 -10.08 C-360.41 -9, -369.54 -9.21, -377.27 -7.67" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(1746.9440149322984 999.0886150201005) rotate(0 -188.22297259405104 9.474853910657117)"><path d="M-356.65 6.48 C-363.02 1.73, -370.66 -4.28, -377.27 -7.67" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g></g><mask></mask><g transform="translate(1255.35046069892 1063.404584871314) rotate(0 464.7999267578125 52.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref, 因为seqA和seqB前4个tokens完全一样，计算出来的hash值是一样的</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">seqA使用的block0可以被seqB ref,注意此时block0 ref_count+=1</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">同时SeqB.num_cached_tokens+=block_size</text></g><g stroke-linecap="round" transform="translate(1806.1011427319334 846.2879664977937) rotate(0 73.10735534858122 70.90032426115431)"><path d="M32 0 C53.48 -0.41, 74.34 -2.39, 114.21 0 C134.77 -2, 146.04 13.49, 146.21 32 C144.73 59.18, 147.44 93.47, 146.21 109.8 C145.21 132.28, 133.56 140.12, 114.21 141.8 C99.75 141.94, 83.15 141.66, 32 141.8 C13.37 140.2, 1.77 131.47, 0 109.8 C3.83 82.65, 3.47 58.65, 0 32 C-3.07 9.62, 13.55 0.1, 32 0" stroke="none" stroke-width="0" fill="#ffec99"></path><path d="M32 0 C55.13 -1.56, 82.41 -1.31, 114.21 0 M32 0 C63.71 0.08, 94.1 0.19, 114.21 0 M114.21 0 C137.23 0.87, 146.75 12.56, 146.21 32 M114.21 0 C135.51 -1.2, 144.7 10.07, 146.21 32 M146.21 32 C147.77 56.9, 144.09 82.23, 146.21 109.8 M146.21 32 C146.6 56.23, 144.85 80.43, 146.21 109.8 M146.21 109.8 C144.35 132.16, 135.35 140.1, 114.21 141.8 M146.21 109.8 C144.73 133.07, 135.29 139.81, 114.21 141.8 M114.21 141.8 C93.84 141.3, 76.46 140.46, 32 141.8 M114.21 141.8 C93.78 140.2, 73.52 141.52, 32 141.8 M32 141.8 C9.43 142.16, -1.62 130.58, 0 109.8 M32 141.8 C12.67 142.01, 2.17 129.27, 0 109.8 M0 109.8 C1.65 93.88, -0.48 77.46, 0 32 M0 109.8 C0.22 78.27, 1.2 48.24, 0 32 M0 32 C1.7 10.7, 9.61 -0.95, 32 0 M0 32 C-0.51 8.87, 11.39 2, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1813.2084980805146 854.688290758948) rotate(0 66 62.5)"><text x="66" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id=2</text><text x="66" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref_count=0</text><text x="66" y="67.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">hash=53367</text><text x="66" y="92.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[5</text><text x="66" y="117.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">,33,6,7]</text></g><g stroke-linecap="round"><g transform="translate(1297.3610041772815 756.5361851419137) rotate(0 233.0045077527543 -4.341511157812022)"><path d="M-1.03 1 C50.04 -13.27, 227.23 -98.38, 305.24 -85.29 C383.25 -72.19, 440.3 52.07, 467.04 79.57 M0.63 0.48 C51.63 -14.15, 226.57 -99.81, 304.2 -86.94 C381.82 -74.08, 439.53 50.23, 466.39 77.66" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1297.3610041772815 756.5361851419137) rotate(0 233.0045077527543 -4.341511157812022)"><path d="M445.79 63.48 C451.66 66.2, 455.61 69.74, 466.39 77.66 M445.79 63.48 C454.09 68.98, 461.1 74.71, 466.39 77.66" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1297.3610041772815 756.5361851419137) rotate(0 233.0045077527543 -4.341511157812022)"><path d="M459.72 53.56 C462.81 58.16, 463.95 63.69, 466.39 77.66 M459.72 53.56 C462.79 62.82, 464.67 72.21, 466.39 77.66" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1490.9684805796976 828.6852471678359) rotate(0 -0.5799080133149346 -18.515704507942274)"><path d="M-0.09 0.4 C-0.19 -5.91, -0.8 -31.14, -1.07 -37.44" stroke="#1e1e1e" stroke-width="2.5" fill="none" stroke-dasharray="8 10"></path></g><g transform="translate(1490.9684805796976 828.6852471678359) rotate(0 -0.5799080133149346 -18.515704507942274)"><path d="M5.96 -19.88 C5.08 -23.47, 3.52 -28.31, -1.07 -37.44" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g><g transform="translate(1490.9684805796976 828.6852471678359) rotate(0 -0.5799080133149346 -18.515704507942274)"><path d="M-6.97 -19.46 C-5.09 -23.14, -3.87 -28.07, -1.07 -37.44" stroke="#1e1e1e" stroke-width="2.5" fill="none"></path></g></g><mask></mask><g transform="translate(1424.7897872244823 729.8729019468436) rotate(0 125 25)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">注意只有block被token填满</text><text x="0" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block的hash才不为-1</text></g><g stroke-linecap="round" transform="translate(1776.493862326831 619.9250593239814) rotate(0 232.41570026455224 22.5)"><path d="M11.25 0 C152.77 2.94, 293.13 2.37, 453.58 0 M11.25 0 C185.51 1.02, 360.47 1.05, 453.58 0 M453.58 0 C459.47 1.71, 465.55 1.78, 464.83 11.25 M453.58 0 C463.22 0.18, 463.73 2.2, 464.83 11.25 M464.83 11.25 C466.02 17.85, 465.92 27.98, 464.83 33.75 M464.83 11.25 C464.58 15.22, 463.96 20.42, 464.83 33.75 M464.83 33.75 C465.48 39.58, 460.32 44.66, 453.58 45 M464.83 33.75 C462.98 40.1, 459.5 43.29, 453.58 45 M453.58 45 C315.66 45.34, 177.26 45.15, 11.25 45 M453.58 45 C333.63 44.8, 212.33 44.93, 11.25 45 M11.25 45 C2.11 46.22, 0.79 40.33, 0 33.75 M11.25 45 C4.98 47.24, -1.28 39.65, 0 33.75 M0 33.75 C0.65 29.18, 0.17 20.16, 0 11.25 M0 33.75 C0.37 28.93, -0.18 22.78, 0 11.25 M0 11.25 C1.37 3.02, 4.09 -1.81, 11.25 0 M0 11.25 C-0.88 3.25, 2.48 -0.11, 11.25 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1808.7096419370864 624.9250593239814) rotate(0 200.19992065429688 17.5)"><text x="200.19992065429688" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">BlockManager.used_block_id</text></g><g transform="translate(1814.221143067455 697.3487850996172) rotate(0 143 25)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_id 0,1,2 add into </text><text x="0" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">blockManager.used_block_id</text></g><g stroke-linecap="round"><g transform="translate(1245.4240637319538 932.3724468837974) rotate(0 -172.35983781948045 18.59343540879472)"><path d="M-0.02 -0.63 C-15.17 -6.15, -33.26 -43.82, -90.59 -32 C-147.92 -20.19, -301.58 53.02, -344 70.28 M-1.49 1.66 C-16.29 -3.18, -31.09 -42.27, -88.29 -30.63 C-145.5 -18.99, -301.86 54.78, -344.7 71.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1245.4240637319538 932.3724468837974) rotate(0 -172.35983781948045 18.59343540879472)"><path d="M-326.48 54.35 C-333.32 58.63, -338.75 65.76, -344.7 71.47 M-326.48 54.35 C-331.36 58.32, -335.9 64.18, -344.7 71.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1245.4240637319538 932.3724468837974) rotate(0 -172.35983781948045 18.59343540879472)"><path d="M-319.74 70.07 C-328.93 69.2, -336.57 71.2, -344.7 71.47 M-319.74 70.07 C-326.38 69.69, -332.81 71.15, -344.7 71.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(968.5379801419868 988.8025735067189) rotate(0 176.00000000000006 25)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">sequence A and B update:</text><text x="0" y="42.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">seq.block_table.append(block_id)</text></g><g stroke-linecap="round" transform="translate(586.2486888075117 1066.6139494404456) rotate(0 31.16977417810415 34.57017410506978)"><path d="M15.58 0 C26.2 3.57, 33.14 -0.57, 46.75 0 C59.59 -1.38, 65.04 3.6, 62.34 15.58 C59.35 30.62, 65.05 39.66, 62.34 53.56 C64.62 62.23, 54.07 68.09, 46.75 69.14 C38.36 68.96, 19.7 66.43, 15.58 69.14 C4.51 67.67, -2.51 60.84, 0 53.56 C1.68 48.47, 2.59 37.84, 0 15.58 C-1.09 8.73, 7.79 -3.58, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C22.48 -1.64, 31.88 0.69, 46.75 0 M15.58 0 C21.38 -0.7, 28.9 0.27, 46.75 0 M46.75 0 C55.17 1.12, 60.48 6.22, 62.34 15.58 M46.75 0 C56.91 -1.96, 60.86 7.13, 62.34 15.58 M62.34 15.58 C61.02 27.21, 60.34 36.77, 62.34 53.56 M62.34 15.58 C61.35 25.58, 62.16 36.08, 62.34 53.56 M62.34 53.56 C63.21 64.61, 55.91 69.5, 46.75 69.14 M62.34 53.56 C60.48 63.31, 59.15 69.35, 46.75 69.14 M46.75 69.14 C33.35 67.23, 23.4 69.66, 15.58 69.14 M46.75 69.14 C38.28 68.75, 30.7 68.82, 15.58 69.14 M15.58 69.14 C6.73 69.65, 1.7 63.98, 0 53.56 M15.58 69.14 C3.99 68.05, -0.51 62.14, 0 53.56 M0 53.56 C0.47 42.34, -1.06 28.71, 0 15.58 M0 53.56 C-0.41 45.55, 0.93 38.53, 0 15.58 M0 15.58 C0.44 4.63, 4.2 -1.72, 15.58 0 M0 15.58 C0.59 5.78, 4.55 0.73, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(584.9280643419194 1144.526158433328) rotate(0 31.16977417810415 34.57017410506978)"><path d="M15.58 0 C24.22 -1.58, 30.73 -1.86, 46.75 0 C59.85 -1.6, 64.11 5.53, 62.34 15.58 C64.4 25.21, 64.04 37.99, 62.34 53.56 C59.27 62.89, 60.03 69.25, 46.75 69.14 C36.94 67.01, 33.16 67.72, 15.58 69.14 C2.69 66.03, -3.21 64, 0 53.56 C2.28 42.41, -1.41 34.2, 0 15.58 C2.6 1.62, 6.15 2.85, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C26.99 0.97, 32.99 2.11, 46.75 0 M15.58 0 C25.94 0.5, 33.78 0.77, 46.75 0 M46.75 0 C55.28 1.03, 62.14 3.49, 62.34 15.58 M46.75 0 C55.66 1.94, 62.09 3.2, 62.34 15.58 M62.34 15.58 C60.48 23.46, 61.81 31.26, 62.34 53.56 M62.34 15.58 C62.2 24.1, 62.51 34.91, 62.34 53.56 M62.34 53.56 C61.1 64.31, 55.53 68.58, 46.75 69.14 M62.34 53.56 C64.35 64.16, 59.31 67.27, 46.75 69.14 M46.75 69.14 C41.28 69.67, 32.45 69.96, 15.58 69.14 M46.75 69.14 C34.16 68.3, 22.76 69.18, 15.58 69.14 M15.58 69.14 C6.89 69.17, -1.05 63, 0 53.56 M15.58 69.14 C4.69 67.34, 0.73 65.94, 0 53.56 M0 53.56 C-0.88 43.36, -1.96 31.73, 0 15.58 M0 53.56 C1 43.88, 0.43 32.13, 0 15.58 M0 15.58 C-1 3.47, 5.71 0.51, 15.58 0 M0 15.58 C-0.64 5.93, 3.93 -1.07, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(664.1003003671384 1070.196539646488) rotate(0 55 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence A</text></g><g transform="translate(662.7796759015463 1183.7632919718349) rotate(0 55 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence B</text></g><g transform="translate(664.996220804612 1091.8895370180512) rotate(0 93.5 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_table=[0,1]</text></g><g transform="translate(662.7880384006812 1156.0318909359198) rotate(0 93.5 12.5)"><text x="0" y="17.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">block_table=[0,2]</text></g><g stroke-linecap="round" transform="translate(239.94787447853855 479.52017789932864) rotate(0 1039.9694760460125 613.582775340367)"><path d="M32 0 C790.44 0, 1548.87 0, 2047.94 0 M32 0 C465.05 0, 898.1 0, 2047.94 0 M2047.94 0 C2069.27 0, 2079.94 10.67, 2079.94 32 M2047.94 0 C2069.27 0, 2079.94 10.67, 2079.94 32 M2079.94 32 C2079.94 395.55, 2079.94 759.11, 2079.94 1195.17 M2079.94 32 C2079.94 348.65, 2079.94 665.3, 2079.94 1195.17 M2079.94 1195.17 C2079.94 1216.5, 2069.27 1227.17, 2047.94 1227.17 M2079.94 1195.17 C2079.94 1216.5, 2069.27 1227.17, 2047.94 1227.17 M2047.94 1227.17 C1486.14 1227.17, 924.35 1227.17, 32 1227.17 M2047.94 1227.17 C1538.58 1227.17, 1029.22 1227.17, 32 1227.17 M32 1227.17 C10.67 1227.17, 0 1216.5, 0 1195.17 M32 1227.17 C10.67 1227.17, 0 1216.5, 0 1195.17 M0 1195.17 C0 754.84, 0 314.52, 0 32 M0 1195.17 C0 816.73, 0 438.3, 0 32 M0 32 C0 10.67, 10.67 0, 32 0 M0 32 C0 10.67, 10.67 0, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(531.2214714661434 239.84277643982557) rotate(0 127.18493050819089 136.3869025341097)"><path d="M-1.12 0.62 C-4 21.66, -66.86 81.54, -18.48 126.92 C29.91 172.29, 237.82 248.9, 289.21 272.88 M0.5 -0.11 C-2.45 20.99, -68.02 82.72, -19.49 127.92 C29.04 173.11, 240.11 247.16, 291.69 271.07" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(531.2214714661434 239.84277643982557) rotate(0 127.18493050819089 136.3869025341097)"><path d="M266.71 270.12 C272.77 270.35, 275.06 269.45, 291.69 271.07 M266.71 270.12 C275.58 270.21, 286.23 270.23, 291.69 271.07" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(531.2214714661434 239.84277643982557) rotate(0 127.18493050819089 136.3869025341097)"><path d="M273.17 254.29 C278.01 257.63, 279.01 259.92, 291.69 271.07 M273.17 254.29 C279.54 260.4, 287.71 266.51, 291.69 271.07" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1830.1709192693722 813.1439646991407) rotate(0 185.2942701351526 -68.60208735190703)"><path d="M-0.12 -1.02 C40.04 -8.16, 177.76 -19.32, 239.82 -42.19 C301.88 -65.06, 350.29 -122.32, 372.23 -138.26 M-1.64 1.06 C39 -6.45, 179.95 -20.69, 242.13 -43.78 C304.3 -66.87, 349.87 -121.95, 371.4 -137.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1830.1709192693722 813.1439646991407) rotate(0 185.2942701351526 -68.60208735190703)"><path d="M359.48 -115.51 C360.13 -121.33, 365.98 -124.81, 371.4 -137.49 M359.48 -115.51 C362.51 -120.98, 364.34 -125, 371.4 -137.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1830.1709192693722 813.1439646991407) rotate(0 185.2942701351526 -68.60208735190703)"><path d="M348.14 -128.31 C351.2 -131.48, 359.4 -132.31, 371.4 -137.49 M348.14 -128.31 C353.49 -130.99, 357.74 -132.28, 371.4 -137.49" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(472.746309934666 1236.9022108197826) rotate(0 893.966532389323 227.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">优先prefill </text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">while self.waiting and num_seqs &lt; self.max_num_seqs:</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    不断地从scheduler.waiting deque取Sequence; 直到整个batch的tokens num &gt;= config.max_num_batched_tokens</text><text x="0" y="129.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    或者blockManager没有free block可为新Seqence token分配</text><text x="0" y="164.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">再decode</text><text x="0" y="199.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">while self.running and num_seqs &lt; self.max_num_seqs:</text><text x="0" y="234.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    不断地从scheduler.running deque取Sequence;直到blockManager没有free block可为新decode出来的Seqence token分配</text><text x="0" y="269.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    期间会尝试将running deque最右侧(即优先度最低)的Sequence驱逐(scheduler.preempt())出去即将Sequence放回到waiting deque</text><text x="0" y="304.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    同时释放掉Sequence占用的资源，即BlockManager中的block</text><text x="0" y="339.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="374.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">返回值为list[Sequence]和is_prefill, 在nano-vllm中一次forward只能处理prefill和decode其中一种</text><text x="0" y="409.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="444.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">注意当seqence从schedule.waiting deque或者running deque选择出来时才执行BlockManager.allocate</text></g><g transform="translate(209.53696520528422 10) rotate(0 197.9998779296875 22.5)"><text x="0" y="31.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="36px" fill="#2f9e44" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">LLMEngine.generate()</text></g><g transform="translate(580.1301702669258 1772.9902172745947) rotate(0 269.4998779296875 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ModelRunner.prepare_prefille/decode</text></g><g transform="translate(411.6853307648348 1848.4636362253896) rotate(0 847.6998291015625 122.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">cu_seqlens_q=[0,5,9] #seq token数量前缀和</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">cu_seqlens_k=[0,5,13] #seq token数量前缀和,考虑了seqB前4个prefix cache token</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">slot_mapping=[0,1,2,3,4,5, 8,9,10,11] #每个token在GPU Block上以token粒度的绝对位置</text><text x="0" y="129.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">计算方式为(token所属的block_id*block_size)+token在seq中的绝对位置</text><text x="0" y="164.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="199.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">input_ids=[1,2,3,4,5, 5,33,6,7] #seqB前4个token作为prefix cache前缀cache已在seqA block0中,所以不重复放入input_ids</text><text x="0" y="234.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">positions=[0,1,2,3,4, 4,5,6,7] #各个seq的token在seq中的绝对位置</text></g><g stroke-linecap="round" transform="translate(400.4344783116462 1829.1460166400984) rotate(0 622.3617220637244 82.93938368857516)"><path d="M32 0 C340.97 0, 649.95 0, 1212.72 0 M32 0 C269.84 0, 507.68 0, 1212.72 0 M1212.72 0 C1234.06 0, 1244.72 10.67, 1244.72 32 M1212.72 0 C1234.06 0, 1244.72 10.67, 1244.72 32 M1244.72 32 C1244.72 66.58, 1244.72 101.17, 1244.72 133.88 M1244.72 32 C1244.72 56.18, 1244.72 80.35, 1244.72 133.88 M1244.72 133.88 C1244.72 155.21, 1234.06 165.88, 1212.72 165.88 M1244.72 133.88 C1244.72 155.21, 1234.06 165.88, 1212.72 165.88 M1212.72 165.88 C838.52 165.88, 464.32 165.88, 32 165.88 M1212.72 165.88 C753.23 165.88, 293.73 165.88, 32 165.88 M32 165.88 C10.67 165.88, 0 155.21, 0 133.88 M32 165.88 C10.67 165.88, 0 155.21, 0 133.88 M0 133.88 C0 106.46, 0 79.04, 0 32 M0 133.88 C0 101.51, 0 69.15, 0 32 M0 32 C0 10.67, 10.67 0, 32 0 M0 32 C0 10.67, 10.67 0, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(280.6052930533191 1867.9177548265193) rotate(0 53.89997863769531 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Context</text></g><g stroke-linecap="round" transform="translate(751.5033579428748 2206.96776851468) rotate(0 228.95644242713354 49.30496661708139)"><path d="M24.65 0 C118.03 0.19, 213.96 -0.97, 433.26 0 M24.65 0 C155.16 0.68, 285.22 0.18, 433.26 0 M433.26 0 C447.99 -1.11, 456.27 9.44, 457.91 24.65 M433.26 0 C450.6 -1.06, 459.14 10.45, 457.91 24.65 M457.91 24.65 C456.31 38.24, 458.07 50.46, 457.91 73.96 M457.91 24.65 C457.43 38.74, 457.97 55.26, 457.91 73.96 M457.91 73.96 C457.46 91.19, 451.07 97.88, 433.26 98.61 M457.91 73.96 C458.3 88.31, 448.82 98.11, 433.26 98.61 M433.26 98.61 C334.31 100.63, 233.08 99.83, 24.65 98.61 M433.26 98.61 C345.7 99.36, 258.15 98.92, 24.65 98.61 M24.65 98.61 C6.29 100.26, 1.68 91.66, 0 73.96 M24.65 98.61 C7.51 100.17, -0.88 92.12, 0 73.96 M0 73.96 C0.11 59.65, 0.74 50.22, 0 24.65 M0 73.96 C-1.17 62.21, 0.49 51.07, 0 24.65 M0 24.65 C-1.86 10.13, 8.4 -1.87, 24.65 0 M0 24.65 C-1.4 7.78, 7.28 -1.6, 24.65 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(772.5598827674692 2221.2727351317617) rotate(0 207.89991760253906 35)"><text x="207.89991760253906" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">model =</text><text x="207.89991760253906" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Qwen3ForCausalLM(hf_config)</text></g><g transform="translate(1156.7505643886313 2596.1549162196898) rotate(0 432.599853515625 52.499999999999886)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">模型预测出各个Seqence的next token, 返回token_ids:list[int]</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence A next token=f, token_id=6</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence B next token=h, token_id=8</text></g><g stroke-linecap="round"><g transform="translate(1542.071250115643 2712.1549162196898) rotate(0 -256.25453787867946 74.76508584608041)"><path d="M1.13 -0.97 C-8.31 22.12, 30.38 114.66, -55.6 138.68 C-141.58 162.7, -438.46 142.6, -514.75 143.13 M0.27 1.13 C-8.9 24.36, 32.01 116.53, -53.43 139.87 C-138.87 163.21, -435.81 140.71, -512.37 141.17" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1542.071250115643 2712.1549162196898) rotate(0 -256.25453787867946 74.76508584608041)"><path d="M-488.6 133.41 C-499.42 134.94, -508.12 138, -512.37 141.17 M-488.6 133.41 C-496.62 137.08, -506.29 138.21, -512.37 141.17" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1542.071250115643 2712.1549162196898) rotate(0 -256.25453787867946 74.76508584608041)"><path d="M-489.18 150.51 C-499.79 145.4, -508.26 141.85, -512.37 141.17 M-489.18 150.51 C-497.05 148, -506.51 142.96, -512.37 141.17" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(1566.8447814887406 2191.025527012578) rotate(0 208.59994506835938 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">input_ids和positions作为输入</text></g><g transform="translate(1189.1849608942503 2330.129087757442) rotate(0 56 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">模型输出</text></g><g stroke-linecap="round" transform="translate(243.01574960515404 2510.761009821713) rotate(0 1033.492715760317 460.3476244023176)"><path d="M32 0 C468.45 0, 904.89 0, 2034.99 0 M32 0 C493.16 0, 954.32 0, 2034.99 0 M2034.99 0 C2056.32 0, 2066.99 10.67, 2066.99 32 M2034.99 0 C2056.32 0, 2066.99 10.67, 2066.99 32 M2066.99 32 C2066.99 347.89, 2066.99 663.78, 2066.99 888.7 M2066.99 32 C2066.99 284.85, 2066.99 537.69, 2066.99 888.7 M2066.99 888.7 C2066.99 910.03, 2056.32 920.7, 2034.99 920.7 M2066.99 888.7 C2066.99 910.03, 2056.32 920.7, 2034.99 920.7 M2034.99 920.7 C1265.52 920.7, 496.05 920.7, 32 920.7 M2034.99 920.7 C1335.66 920.7, 636.34 920.7, 32 920.7 M32 920.7 C10.67 920.7, 0 910.03, 0 888.7 M32 920.7 C10.67 920.7, 0 910.03, 0 888.7 M0 888.7 C0 623.67, 0 358.64, 0 32 M0 888.7 C0 708.05, 0 527.4, 0 32 M0 32 C0 10.67, 10.67 0, 32 0 M0 32 C0 10.67, 10.67 0, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(1207.7531337685627 2283.723890331427) rotate(0 473.726357920576 170.24731608811067)"><path d="M1.05 0.11 C151.05 33.79, 761.87 145.01, 899.06 201.73 C1036.25 258.44, 836.65 317.06, 824.17 340.4 M0.14 -0.88 C150.17 32.95, 760.98 145.71, 898.71 202.76 C1036.44 259.8, 838.99 318.56, 826.53 341.37" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1207.7531337685627 2283.723890331427) rotate(0 473.726357920576 170.24731608811067)"><path d="M841.99 321.72 C838.73 328.05, 833.54 328.77, 826.53 341.37 M841.99 321.72 C838.45 326.16, 834.81 332.39, 826.53 341.37" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1207.7531337685627 2283.723890331427) rotate(0 473.726357920576 170.24731608811067)"><path d="M851 336.26 C845.81 339.48, 838.64 337.01, 826.53 341.37 M851 336.26 C845.38 337.2, 839.54 339.88, 826.53 341.37" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(274.4763529991882 2166.033956354572) rotate(0 168.29989624023438 22.5)"><text x="0" y="31.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="36px" fill="#2f9e44" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ModelRunner.Run()</text></g><g stroke-linecap="round" transform="translate(825.0592416597349 2712.208452580001) rotate(0 31.16977417810415 34.57017410506978)"><path d="M15.58 0 C27.73 2.13, 38.07 -3.47, 46.75 0 C58.76 2.95, 65.1 4.96, 62.34 15.58 C64.21 28, 64.33 32.49, 62.34 53.56 C60.34 67.05, 60.37 65.66, 46.75 69.14 C33 65.27, 27.16 69.14, 15.58 69.14 C8.21 72.61, -1.26 62.65, 0 53.56 C-0.75 40.73, -2.37 26.91, 0 15.58 C-2.11 6.08, 3.83 -1.13, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C25.21 -0.25, 36.37 1.71, 46.75 0 M15.58 0 C25.2 -0.48, 35.64 -0.79, 46.75 0 M46.75 0 C57.78 1.74, 61.89 5.99, 62.34 15.58 M46.75 0 C58.73 -0.84, 62.73 3.12, 62.34 15.58 M62.34 15.58 C62.16 27.1, 64.04 35.92, 62.34 53.56 M62.34 15.58 C62.41 26.15, 61.87 36.53, 62.34 53.56 M62.34 53.56 C61.24 63.01, 55.22 70.8, 46.75 69.14 M62.34 53.56 C64.28 65.41, 56.43 70.7, 46.75 69.14 M46.75 69.14 C39.59 69.19, 30.8 67.3, 15.58 69.14 M46.75 69.14 C36.5 68.45, 24.12 68.64, 15.58 69.14 M15.58 69.14 C6.8 69.2, -1.86 65.86, 0 53.56 M15.58 69.14 C5.41 66.99, -1.4 63.51, 0 53.56 M0 53.56 C-1.52 43.74, 0.29 34.82, 0 15.58 M0 53.56 C-0.58 40.07, 0.45 23.62, 0 15.58 M0 15.58 C0.53 6.78, 4.49 -0.23, 15.58 0 M0 15.58 C-0.54 4.11, 7.01 1.01, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1608.8460534765097 2798.2587728304884) rotate(0 89.5999755859375 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">更新Seqences</text></g><g stroke-linecap="round" transform="translate(924.1129031780993 2809.3719859281896) rotate(0 31.16977417810415 34.57017410506978)"><path d="M15.58 0 C28.43 3.49, 40.79 0.29, 46.75 0 C54.93 -0.99, 59.55 7.25, 62.34 15.58 C60.76 33.64, 65.98 41.99, 62.34 53.56 C64.8 62.28, 54.14 66.87, 46.75 69.14 C43.37 72.69, 32.68 67.92, 15.58 69.14 C7.73 67.21, -0.46 62.83, 0 53.56 C-1.59 41.75, -0.84 27.03, 0 15.58 C0.32 1.62, 3.69 2.59, 15.58 0" stroke="none" stroke-width="0" fill="#ffc9c9"></path><path d="M15.58 0 C24.78 1.46, 32.99 -1.29, 46.75 0 M15.58 0 C23.78 1.11, 31.11 0.64, 46.75 0 M46.75 0 C58.52 -0.73, 62.68 3.39, 62.34 15.58 M46.75 0 C56.27 -0.5, 61.06 5.08, 62.34 15.58 M62.34 15.58 C62.11 28.96, 60.96 44.84, 62.34 53.56 M62.34 15.58 C61.68 27.47, 61.27 41.12, 62.34 53.56 M62.34 53.56 C64.02 65.22, 56.53 70.5, 46.75 69.14 M62.34 53.56 C61.45 65.67, 56.13 70.27, 46.75 69.14 M46.75 69.14 C38.1 70.35, 26.12 70.14, 15.58 69.14 M46.75 69.14 C39.69 69.08, 30.09 70.01, 15.58 69.14 M15.58 69.14 C5.38 67.27, -1.22 63.56, 0 53.56 M15.58 69.14 C4.25 67.54, -1.99 61.9, 0 53.56 M0 53.56 C1.62 43.56, 0.16 30.06, 0 15.58 M0 53.56 C-0.01 39.23, -0.62 23.21, 0 15.58 M0 15.58 C-0.47 4.25, 6.78 0.87, 15.58 0 M0 15.58 C2.11 4.24, 5.35 -0.04, 15.58 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(737.9580457145178 2675.305715056753) rotate(0 76.99996948242188 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence A</text></g><g transform="translate(845.8941787822573 2895.2066080930176) rotate(0 76.99996948242188 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Sequence B</text></g><g transform="translate(445.7078529949845 2729.9814998802244) rotate(0 177.0999298095703 35)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">prompt: "abcdef"</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[1,2,3,4,5,6]</text></g><g transform="translate(447.2954336928558 2809.020793083602) rotate(0 230.99990844726562 35)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">prompt: "abcde fgh"</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">token_ids=[1,2,3,4,5,33,6,7,8]</text></g><g transform="translate(433.81968533854183 2945.31414658949) rotate(0 737.0997924804688 17.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#e03131" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">注意此时Seqence的block_table并没有更新.其会在scheduler.scheduler()时在blockManager.allocate()中更新</text></g><g stroke-linecap="round"><g transform="translate(1140.0111778331166 2991.31414658949) rotate(0 120.75089629295883 66.79125045029377)"><path d="M0.82 -0.44 C41.15 21.87, 201.67 111.73, 241.7 134.33 M-0.2 -1.72 C40.01 20.66, 200.82 112.29, 240.86 135.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1140.0111778331166 2991.31414658949) rotate(0 120.75089629295883 66.79125045029377)"><path d="M216.22 131.06 C222.34 132.41, 228.1 132.48, 240.86 135.3 M216.22 131.06 C223.84 133.15, 230.14 133.15, 240.86 135.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1140.0111778331166 2991.31414658949) rotate(0 120.75089629295883 66.79125045029377)"><path d="M224.71 116.22 C228.53 121.74, 231.94 125.93, 240.86 135.3 M224.71 116.22 C229.89 122.43, 233.82 126.57, 240.86 135.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(1211.599576457711 3137.72862447437) rotate(0 400.3998413085937 87.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">检查Sequence是否已经完成，判断条件为：</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">1.Sequence的最后一个token为终止符且模型不忽略终止符</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">2.或者已经达到了一条Sequence生成的最大token限制：</text><text x="0" y="129.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">if (not seq.ignore_eos and token_id == self.eos) or </text><text x="0" y="164.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">seq.num_completion_tokens == seq.max_tokens</text></g><g stroke-linecap="round"><g transform="translate(1200.599576457711 3221.9950793676703) rotate(0 -39.25465617131471 -0.41189090382727045)"><path d="M-0.46 -0.26 C-13.83 -0.23, -67.02 -0.97, -80.01 -0.89 M1.5 -1.44 C-11.49 -1.11, -64.29 0.63, -77.65 0.62" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1200.599576457711 3221.9950793676703) rotate(0 -39.25465617131471 -0.41189090382727045)"><path d="M-54.32 -8.36 C-62.23 -6.71, -69.29 -1.19, -77.65 0.62 M-54.32 -8.36 C-63.88 -5.79, -72.2 -1.19, -77.65 0.62" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1200.599576457711 3221.9950793676703) rotate(0 -39.25465617131471 -0.41189090382727045)"><path d="M-54.01 8.74 C-61.86 4.96, -69.02 5.07, -77.65 0.62 M-54.01 8.74 C-63.72 4.65, -72.17 2.6, -77.65 0.62" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(386.4517221564515 3155.5011435644433) rotate(0 361.8999328613281 52.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">若Sequence已经完成则将Sequence状态设置为FINISHED</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">释放掉Sequence占用的资源(即BlockManager中的block)</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">同时将Sequence移出scheduler.running deque</text></g><g stroke-linecap="round" transform="translate(10 466.8829680497952) rotate(0 1172.7478056570171 1492.3820462074777)"><path d="M32 0 C589.99 0, 1147.98 0, 2313.5 0 M32 0 C520.03 0, 1008.06 0, 2313.5 0 M2313.5 0 C2334.83 0, 2345.5 10.67, 2345.5 32 M2313.5 0 C2334.83 0, 2345.5 10.67, 2345.5 32 M2345.5 32 C2345.5 778.76, 2345.5 1525.52, 2345.5 2952.76 M2345.5 32 C2345.5 710.64, 2345.5 1389.28, 2345.5 2952.76 M2345.5 2952.76 C2345.5 2974.1, 2334.83 2984.76, 2313.5 2984.76 M2345.5 2952.76 C2345.5 2974.1, 2334.83 2984.76, 2313.5 2984.76 M2313.5 2984.76 C1826.06 2984.76, 1338.62 2984.76, 32 2984.76 M2313.5 2984.76 C1610.14 2984.76, 906.79 2984.76, 32 2984.76 M32 2984.76 C10.67 2984.76, 0 2974.1, 0 2952.76 M32 2984.76 C10.67 2984.76, 0 2974.1, 0 2952.76 M0 2952.76 C0 2056.54, 0 1160.32, 0 32 M0 2952.76 C0 1852.91, 0 753.06, 0 32 M0 32 C0 10.67, 10.67 0, 32 0 M0 32 C0 10.67, 10.67 0, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(258.0300089485987 2536.2273448425176) rotate(0 227.69985961914062 22.5)"><text x="0" y="31.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="36px" fill="#2f9e44" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Scheduler.postprocess()</text></g><g stroke-linecap="round" transform="translate(237.68374967408272 1727.738014934348) rotate(0 1040.3144015562716 345.2654562643211)"><path d="M32 0 C681.62 0, 1331.24 0, 2048.63 0 M32 0 C701.01 0, 1370.01 0, 2048.63 0 M2048.63 0 C2069.96 0, 2080.63 10.67, 2080.63 32 M2048.63 0 C2069.96 0, 2080.63 10.67, 2080.63 32 M2080.63 32 C2080.63 166.79, 2080.63 301.58, 2080.63 658.53 M2080.63 32 C2080.63 201.67, 2080.63 371.35, 2080.63 658.53 M2080.63 658.53 C2080.63 679.86, 2069.96 690.53, 2048.63 690.53 M2080.63 658.53 C2080.63 679.86, 2069.96 690.53, 2048.63 690.53 M2048.63 690.53 C1349.06 690.53, 649.49 690.53, 32 690.53 M2048.63 690.53 C1644.11 690.53, 1239.59 690.53, 32 690.53 M32 690.53 C10.67 690.53, 0 679.86, 0 658.53 M32 690.53 C10.67 690.53, 0 679.86, 0 658.53 M0 658.53 C0 530.22, 0 401.91, 0 32 M0 658.53 C0 519.12, 0 379.7, 0 32 M0 32 C0 10.67, 10.67 0, 32 0 M0 32 C0 10.67, 10.67 0, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(2087.557482774474 2104.4636362253896) rotate(0 -427.7649222496656 58.99165371077993)"><path d="M-0.74 0.22 C-13.95 5.22, 65.68 10.91, -78.7 30.42 C-223.08 49.94, -735.67 103.02, -867.04 117.32 M1.07 -0.71 C-11.81 4.43, 68.22 11.89, -76.5 31.79 C-221.22 51.69, -735.05 104.52, -867.26 118.7" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2087.557482774474 2104.4636362253896) rotate(0 -427.7649222496656 58.99165371077993)"><path d="M-844.79 107.73 C-852.11 109.74, -860.74 116.87, -867.26 118.7 M-844.79 107.73 C-852.49 110.38, -859.41 114.94, -867.26 118.7" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(2087.557482774474 2104.4636362253896) rotate(0 -427.7649222496656 58.99165371077993)"><path d="M-843 124.74 C-850.98 120.9, -860.23 122.18, -867.26 118.7 M-843 124.74 C-851.41 122.12, -858.88 121.41, -867.26 118.7" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(470.4479633402841 1059.8897210317664) rotate(0 -49.650039406019715 378.82865833806505)"><path d="M0.39 -1 C-29.5 91.82, -193.6 429.89, -180.23 556.33 C-166.87 682.77, 37.08 724.15, 80.58 757.66 M-0.86 1.08 C-30.88 94.14, -195.39 431.5, -181.42 557.76 C-167.45 684.02, 39.3 725.29, 82.96 758.66" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(470.4479633402841 1059.8897210317664) rotate(0 -49.650039406019715 378.82865833806505)"><path d="M58.06 756.52 C62.04 756.16, 69.04 755.8, 82.96 758.66 M58.06 756.52 C64.4 756.25, 70.93 758.11, 82.96 758.66" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(470.4479633402841 1059.8897210317664) rotate(0 -49.650039406019715 378.82865833806505)"><path d="M65.26 741.01 C67.53 744.2, 72.89 747.38, 82.96 758.66 M65.26 741.01 C69.69 744.57, 74.43 750.3, 82.96 758.66" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(40.285432406855875 611.1367734148098) rotate(0 89.09994506835938 45)"><text x="0" y="31.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="36px" fill="#2f9e44" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">LLMEngine</text><text x="0" y="76.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="36px" fill="#2f9e44" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">.step()</text></g><g stroke-linecap="round"><g transform="translate(375.4517221564515 3167.3852160412407) rotate(0 -149.96962789196394 -1272.8543795369537)"><path d="M-0.34 0.38 C-50.65 -261.27, -297.4 -1145.47, -301.57 -1569.58 C-305.75 -1993.69, -71.78 -2381.78, -25.39 -2544.27 M1.69 -0.46 C-48.26 -261.98, -295.08 -1144.07, -299.21 -1568.34 C-303.34 -1992.61, -69.23 -2383.04, -23.1 -2546.09" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(375.4517221564515 3167.3852160412407) rotate(0 -149.96962789196394 -1272.8543795369537)"><path d="M-23.84 -2521.1 C-23.03 -2530.34, -24.35 -2539.29, -23.1 -2546.09 M-23.84 -2521.1 C-24.08 -2529.99, -23.87 -2539.48, -23.1 -2546.09" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(375.4517221564515 3167.3852160412407) rotate(0 -149.96962789196394 -1272.8543795369537)"><path d="M-39.73 -2527.42 C-33.73 -2534.56, -29.88 -2541.46, -23.1 -2546.09 M-39.73 -2527.42 C-33.83 -2534, -27.54 -2541.07, -23.1 -2546.09" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1522.5351408667168 827.3733613096365) rotate(0 132.75348905923556 -76.22676780221666)"><path d="M1.06 1.06 C41.37 -6.22, 197.87 -18.59, 240.91 -44.01 C283.96 -69.44, 256.38 -133.45, 259.36 -151.48 M0.16 0.58 C40.42 -6.55, 197.05 -17.22, 240.14 -42.9 C283.22 -68.58, 255.56 -135.47, 258.68 -153.52" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1522.5351408667168 827.3733613096365) rotate(0 132.75348905923556 -76.22676780221666)"><path d="M269.58 -131.02 C268.99 -135.39, 263.43 -140.65, 258.68 -153.52 M269.58 -131.02 C265.15 -138.09, 262.38 -147.7, 258.68 -153.52" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1522.5351408667168 827.3733613096365) rotate(0 132.75348905923556 -76.22676780221666)"><path d="M252.57 -129.28 C255.76 -134.19, 253.99 -139.84, 258.68 -153.52 M252.57 -129.28 C254.07 -136.93, 257.23 -147.16, 258.68 -153.52" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(28.019781107429935 742.3905976881974) rotate(0 97.29997253417969 87.5)"><text x="0" y="24.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">不断调用</text><text x="0" y="59.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">直到scheduler</text><text x="0" y="94.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">waitingdeuqe</text><text x="0" y="129.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">runningdeque</text><text x="0" y="164.5" font-family="Comic Shanns, monospace, Segoe UI Emoji" font-size="28px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">均为空</text></g></svg>